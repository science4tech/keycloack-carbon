import{a as Zr,b as T,d as vt,e as bn,i as Lr,r as $r,j as z}from"./index-DQq2HTd_.js";const kn="/assets/react-CHdo91hT.svg",Sn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='31.88'%20height='32'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20257'%3e%3cdefs%3e%3clinearGradient%20id='IconifyId1813088fe1fbc01fb466'%20x1='-.828%25'%20x2='57.636%25'%20y1='7.652%25'%20y2='78.411%25'%3e%3cstop%20offset='0%25'%20stop-color='%2341D1FF'%3e%3c/stop%3e%3cstop%20offset='100%25'%20stop-color='%23BD34FE'%3e%3c/stop%3e%3c/linearGradient%3e%3clinearGradient%20id='IconifyId1813088fe1fbc01fb467'%20x1='43.376%25'%20x2='50.316%25'%20y1='2.242%25'%20y2='89.03%25'%3e%3cstop%20offset='0%25'%20stop-color='%23FFEA83'%3e%3c/stop%3e%3cstop%20offset='8.333%25'%20stop-color='%23FFDD35'%3e%3c/stop%3e%3cstop%20offset='100%25'%20stop-color='%23FFA800'%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3cpath%20fill='url(%23IconifyId1813088fe1fbc01fb466)'%20d='M255.153%2037.938L134.897%20252.976c-2.483%204.44-8.862%204.466-11.382.048L.875%2037.958c-2.746-4.814%201.371-10.646%206.827-9.67l120.385%2021.517a6.537%206.537%200%200%200%202.322-.004l117.867-21.483c5.438-.991%209.574%204.796%206.877%209.62Z'%3e%3c/path%3e%3cpath%20fill='url(%23IconifyId1813088fe1fbc01fb467)'%20d='M185.432.063L96.44%2017.501a3.268%203.268%200%200%200-2.634%203.014l-5.474%2092.456a3.268%203.268%200%200%200%203.997%203.378l24.777-5.718c2.318-.535%204.413%201.507%203.936%203.838l-7.361%2036.047c-.495%202.426%201.782%204.5%204.151%203.78l15.304-4.649c2.372-.72%204.652%201.36%204.15%203.788l-11.698%2056.621c-.732%203.542%203.979%205.473%205.943%202.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505%204.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z'%3e%3c/path%3e%3c/svg%3e";var hr={},Fe={};function xn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Dr={exports:{}};const Tn={},In=Object.freeze(Object.defineProperty({__proto__:null,default:Tn},Symbol.toStringTag,{value:"Module"})),En=Zr(In);(function(t,e){(function(r,n){t.exports=n()})(T,function(){var r=r||function(n,i){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof T<"u"&&T.crypto&&(s=T.crypto),!s&&typeof xn=="function")try{s=En}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function l(){}return function(g){var y;return l.prototype=g,y=new l,l.prototype=null,y}}(),d={},o=d.lib={},u=o.Base=function(){return{extend:function(l){var g=c(this);return l&&g.mixIn(l),(!g.hasOwnProperty("init")||this.init===g.init)&&(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var l=this.extend();return l.init.apply(l,arguments),l},init:function(){},mixIn:function(l){for(var g in l)l.hasOwnProperty(g)&&(this[g]=l[g]);l.hasOwnProperty("toString")&&(this.toString=l.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=o.WordArray=u.extend({init:function(l,g){l=this.words=l||[],g!=i?this.sigBytes=g:this.sigBytes=l.length*4},toString:function(l){return(l||w).stringify(this)},concat:function(l){var g=this.words,y=l.words,x=this.sigBytes,P=l.sigBytes;if(this.clamp(),x%4)for(var N=0;N<P;N++){var A=y[N>>>2]>>>24-N%4*8&255;g[x+N>>>2]|=A<<24-(x+N)%4*8}else for(var L=0;L<P;L+=4)g[x+L>>>2]=y[L>>>2];return this.sigBytes+=P,this},clamp:function(){var l=this.words,g=this.sigBytes;l[g>>>2]&=4294967295<<32-g%4*8,l.length=n.ceil(g/4)},clone:function(){var l=u.clone.call(this);return l.words=this.words.slice(0),l},random:function(l){for(var g=[],y=0;y<l;y+=4)g.push(a());return new h.init(g,l)}}),k=d.enc={},w=k.Hex={stringify:function(l){for(var g=l.words,y=l.sigBytes,x=[],P=0;P<y;P++){var N=g[P>>>2]>>>24-P%4*8&255;x.push((N>>>4).toString(16)),x.push((N&15).toString(16))}return x.join("")},parse:function(l){for(var g=l.length,y=[],x=0;x<g;x+=2)y[x>>>3]|=parseInt(l.substr(x,2),16)<<24-x%8*4;return new h.init(y,g/2)}},U=k.Latin1={stringify:function(l){for(var g=l.words,y=l.sigBytes,x=[],P=0;P<y;P++){var N=g[P>>>2]>>>24-P%4*8&255;x.push(String.fromCharCode(N))}return x.join("")},parse:function(l){for(var g=l.length,y=[],x=0;x<g;x++)y[x>>>2]|=(l.charCodeAt(x)&255)<<24-x%4*8;return new h.init(y,g)}},m=k.Utf8={stringify:function(l){try{return decodeURIComponent(escape(U.stringify(l)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(l){return U.parse(unescape(encodeURIComponent(l)))}},_=o.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(l){typeof l=="string"&&(l=m.parse(l)),this._data.concat(l),this._nDataBytes+=l.sigBytes},_process:function(l){var g,y=this._data,x=y.words,P=y.sigBytes,N=this.blockSize,A=N*4,L=P/A;l?L=n.ceil(L):L=n.max((L|0)-this._minBufferSize,0);var J=L*N,B=n.min(J*4,P);if(J){for(var te=0;te<J;te+=N)this._doProcessBlock(x,te);g=x.splice(0,J),y.sigBytes-=B}return new h.init(g,B)},clone:function(){var l=u.clone.call(this);return l._data=this._data.clone(),l},_minBufferSize:0});o.Hasher=_.extend({cfg:u.extend(),init:function(l){this.cfg=this.cfg.extend(l),this.reset()},reset:function(){_.reset.call(this),this._doReset()},update:function(l){return this._append(l),this._process(),this},finalize:function(l){l&&this._append(l);var g=this._doFinalize();return g},blockSize:16,_createHelper:function(l){return function(g,y){return new l.init(y).finalize(g)}},_createHmacHelper:function(l){return function(g,y){return new M.HMAC.init(l,y).finalize(g)}}});var M=d.algo={};return d}(Math);return r})})(Dr);var Nt=Dr.exports,qr={exports:{}};(function(t,e){(function(r,n){t.exports=n(Nt)})(T,function(r){return function(n){var i=r,s=i.lib,a=s.WordArray,c=s.Hasher,d=i.algo,o=[],u=[];(function(){function w(M){for(var l=n.sqrt(M),g=2;g<=l;g++)if(!(M%g))return!1;return!0}function U(M){return(M-(M|0))*4294967296|0}for(var m=2,_=0;_<64;)w(m)&&(_<8&&(o[_]=U(n.pow(m,1/2))),u[_]=U(n.pow(m,1/3)),_++),m++})();var h=[],k=d.SHA256=c.extend({_doReset:function(){this._hash=new a.init(o.slice(0))},_doProcessBlock:function(w,U){for(var m=this._hash.words,_=m[0],M=m[1],l=m[2],g=m[3],y=m[4],x=m[5],P=m[6],N=m[7],A=0;A<64;A++){if(A<16)h[A]=w[U+A]|0;else{var L=h[A-15],J=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,B=h[A-2],te=(B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10;h[A]=J+h[A-7]+te+h[A-16]}var we=y&x^~y&P,Q=_&M^_&l^M&l,$e=(_<<30|_>>>2)^(_<<19|_>>>13)^(_<<10|_>>>22),Re=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),_e=N+Re+we+u[A]+h[A],De=$e+Q;N=P,P=x,x=y,y=g+_e|0,g=l,l=M,M=_,_=_e+De|0}m[0]=m[0]+_|0,m[1]=m[1]+M|0,m[2]=m[2]+l|0,m[3]=m[3]+g|0,m[4]=m[4]+y|0,m[5]=m[5]+x|0,m[6]=m[6]+P|0,m[7]=m[7]+N|0},_doFinalize:function(){var w=this._data,U=w.words,m=this._nDataBytes*8,_=w.sigBytes*8;return U[_>>>5]|=128<<24-_%32,U[(_+64>>>9<<4)+14]=n.floor(m/4294967296),U[(_+64>>>9<<4)+15]=m,w.sigBytes=U.length*4,this._process(),this._hash},clone:function(){var w=c.clone.call(this);return w._hash=this._hash.clone(),w}});i.SHA256=c._createHelper(k),i.HmacSHA256=c._createHmacHelper(k)}(Math),r.SHA256})})(qr);var Cn=qr.exports,Hr={exports:{}};(function(t,e){(function(r,n){t.exports=n(Nt)})(T,function(r){return function(){var n=r,i=n.lib,s=i.WordArray,a=n.enc;a.Base64={stringify:function(d){var o=d.words,u=d.sigBytes,h=this._map;d.clamp();for(var k=[],w=0;w<u;w+=3)for(var U=o[w>>>2]>>>24-w%4*8&255,m=o[w+1>>>2]>>>24-(w+1)%4*8&255,_=o[w+2>>>2]>>>24-(w+2)%4*8&255,M=U<<16|m<<8|_,l=0;l<4&&w+l*.75<u;l++)k.push(h.charAt(M>>>6*(3-l)&63));var g=h.charAt(64);if(g)for(;k.length%4;)k.push(g);return k.join("")},parse:function(d){var o=d.length,u=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var k=0;k<u.length;k++)h[u.charCodeAt(k)]=k}var w=u.charAt(64);if(w){var U=d.indexOf(w);U!==-1&&(o=U)}return c(d,o,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(d,o,u){for(var h=[],k=0,w=0;w<o;w++)if(w%4){var U=u[d.charCodeAt(w-1)]<<w%4*2,m=u[d.charCodeAt(w)]>>>6-w%4*2,_=U|m;h[k>>>2]|=_<<24-k%4*8,k++}return s.create(h,k)}}(),r.enc.Base64})})(Hr);var Rn=Hr.exports,Br={exports:{}};(function(t,e){(function(r,n){t.exports=n(Nt)})(T,function(r){return r.enc.Utf8})})(Br);var On=Br.exports;function nr(t){this.message=t}nr.prototype=new Error,nr.prototype.name="InvalidCharacterError";var mr=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new nr("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,s=0,a="";n=e.charAt(s++);~n&&(r=i%4?64*r+n:n,i++%4)?a+=String.fromCharCode(255&r>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return a};function Un(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(r){return decodeURIComponent(mr(r).replace(/(.)/g,function(n,i){var s=i.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}(e)}catch{return mr(e)}}function nt(t){this.message=t}function Pn(t,e){if(typeof t!="string")throw new nt("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(Un(t.split(".")[r]))}catch(n){throw new nt("Invalid token specified: "+n.message)}}nt.prototype=new Error,nt.prototype.name="InvalidTokenError";const An=Object.freeze(Object.defineProperty({__proto__:null,InvalidTokenError:nt,default:Pn},Symbol.toStringTag,{value:"Module"})),fr=Zr(An);var jn=Object.create,Mt=Object.defineProperty,Nn=Object.getOwnPropertyDescriptor,Mn=Object.getOwnPropertyNames,Zn=Object.getPrototypeOf,Ln=Object.prototype.hasOwnProperty,$n=(t,e)=>{for(var r in e)Mt(t,r,{get:e[r],enumerable:!0})},zr=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Mn(e))!Ln.call(t,i)&&i!==r&&Mt(t,i,{get:()=>e[i],enumerable:!(n=Nn(e,i))||n.enumerable});return t},mt=(t,e,r)=>(r=t!=null?jn(Zn(t)):{},zr(e||!t||!t.__esModule?Mt(r,"default",{value:t,enumerable:!0}):r,t)),Dn=t=>zr(Mt({},"__esModule",{value:!0}),t),Wr={};$n(Wr,{AccessTokenEvents:()=>Vr,CheckSessionIFrame:()=>Fr,ErrorResponse:()=>Te,ErrorTimeout:()=>Zt,InMemoryWebStorage:()=>gr,Log:()=>st,Logger:()=>I,MetadataService:()=>Jr,OidcClient:()=>Gr,OidcClientSettingsStore:()=>Tt,SessionMonitor:()=>Yr,SigninResponse:()=>St,SigninState:()=>Lt,SignoutResponse:()=>Qr,State:()=>je,User:()=>rt,UserManager:()=>ms,UserManagerSettingsStore:()=>nn,Version:()=>ws,WebStorageStateStore:()=>_r});var qn=Dn(Wr),Hn=mt(Nt),Bn=mt(Cn),yr=mt(Rn),zn=mt(On),Wn={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},ue,le,st=(t=>(t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t))(st||{});(t=>{function e(){ue=3,le=Wn}t.reset=e;function r(i){if(!(0<=i&&i<=4))throw new Error("Invalid log level");ue=i}t.setLevel=r;function n(i){le=i}t.setLogger=n})(st||(st={}));var I=class{constructor(t){this._name=t}debug(...t){ue>=4&&le.debug(I._format(this._name,this._method),...t)}info(...t){ue>=3&&le.info(I._format(this._name,this._method),...t)}warn(...t){ue>=2&&le.warn(I._format(this._name,this._method),...t)}error(...t){ue>=1&&le.error(I._format(this._name,this._method),...t)}throw(t){throw this.error(t),t}create(t){const e=Object.create(this);return e._method=t,e.debug("begin"),e}static createStatic(t,e){const r=new I(`${t}.${e}`);return r.debug("begin"),r}static _format(t,e){const r=`[${t}]`;return e?`${r} ${e}:`:r}static debug(t,...e){ue>=4&&le.debug(I._format(t),...e)}static info(t,...e){ue>=3&&le.info(I._format(t),...e)}static warn(t,...e){ue>=2&&le.warn(I._format(t),...e)}static error(t,...e){ue>=1&&le.error(I._format(t),...e)}};st.reset();var Vn="10000000-1000-4000-8000-100000000000",fe=class{static _randomWord(){return Hn.default.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return Vn.replace(/[018]/g,e=>(+e^fe._randomWord()&15>>+e/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return fe.generateUUIDv4()+fe.generateUUIDv4()+fe.generateUUIDv4()}static generateCodeChallenge(t){try{const e=(0,Bn.default)(t);return yr.default.stringify(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(e){throw I.error("CryptoUtils.generateCodeChallenge",e),e}}static generateBasicAuth(t,e){const r=zn.default.parse([t,e].join(":"));return yr.default.stringify(r)}},ke=class{constructor(t){this._name=t,this._logger=new I(`Event('${this._name}')`),this._callbacks=[]}addHandler(t){return this._callbacks.push(t),()=>this.removeHandler(t)}removeHandler(t){const e=this._callbacks.lastIndexOf(t);e>=0&&this._callbacks.splice(e,1)}raise(...t){this._logger.debug("raise:",...t);for(const e of this._callbacks)e(...t)}},Fn=mt(fr),sr=class{static decode(t){try{return(0,Fn.default)(t)}catch(e){throw I.error("JwtUtils.decode",e),e}}},wr=class{static center({...t}){var e,r,n;return t.width==null&&(t.width=(e=[800,720,600,480].find(i=>i<=window.outerWidth/1.618))!=null?e:360),(r=t.left)!=null||(t.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-t.width)/2))),t.height!=null&&((n=t.top)!=null||(t.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-t.height)/2)))),t}static serialize(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}=${typeof r!="boolean"?r:r?"yes":"no"}`).join(",")}},ee=class extends ke{constructor(){super(...arguments),this._logger=new I(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const t=this._expiration-ee.getEpochTime();this._logger.debug("timer completes in",t),this._expiration<=ee.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(t){const e=this._logger.create("init");t=Math.max(Math.floor(t),1);const r=ee.getEpochTime()+t;if(this.expiration===r&&this._timerHandle){e.debug("skipping since already initialized for expiration at",this.expiration);return}this.cancel(),e.debug("using duration",t),this._expiration=r;const n=Math.min(t,5);this._timerHandle=setInterval(this._callback,n*1e3)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},ir=class{static readParams(t,e="query"){if(!t)throw new TypeError("Invalid URL");const n=new URL(t,"http://127.0.0.1")[e==="fragment"?"hash":"search"];return new URLSearchParams(n.slice(1))}},ar=";",Te=class extends Error{constructor(t,e){var r,n,i;if(super(t.error_description||t.error||""),this.form=e,this.name="ErrorResponse",!t.error)throw I.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=t.error,this.error_description=(r=t.error_description)!=null?r:null,this.error_uri=(n=t.error_uri)!=null?n:null,this.state=t.userState,this.session_state=(i=t.session_state)!=null?i:null,this.url_state=t.url_state}},Zt=class extends Error{constructor(t){super(t),this.name="ErrorTimeout"}},Vr=class{constructor(t){this._logger=new I("AccessTokenEvents"),this._expiringTimer=new ee("Access token expiring"),this._expiredTimer=new ee("Access token expired"),this._expiringNotificationTimeInSeconds=t.expiringNotificationTimeInSeconds}load(t){const e=this._logger.create("load");if(t.access_token&&t.expires_in!==void 0){const r=t.expires_in;if(e.debug("access token present, remaining duration:",r),r>0){let i=r-this._expiringNotificationTimeInSeconds;i<=0&&(i=1),e.debug("registering expiring timer, raising in",i,"seconds"),this._expiringTimer.init(i)}else e.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;e.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(t){return this._expiringTimer.addHandler(t)}removeAccessTokenExpiring(t){this._expiringTimer.removeHandler(t)}addAccessTokenExpired(t){return this._expiredTimer.addHandler(t)}removeAccessTokenExpired(t){this._expiredTimer.removeHandler(t)}},Fr=class{constructor(t,e,r,n,i){this._callback=t,this._client_id=e,this._intervalInSeconds=n,this._stopOnError=i,this._logger=new I("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=a=>{a.origin===this._frame_origin&&a.source===this._frame.contentWindow&&(a.data==="error"?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):a.data==="changed"?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(a.data+" message from check session op iframe"))};const s=new URL(r);this._frame_origin=s.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=s.href}load(){return new Promise(t=>{this._frame.onload=()=>{t()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)})}start(t){if(this._session_state===t)return;this._logger.create("start"),this.stop(),this._session_state=t;const e=()=>{!this._frame.contentWindow||!this._session_state||this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};e(),this._timer=setInterval(e,this._intervalInSeconds*1e3)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},gr=class{constructor(){this._logger=new I("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(t){return this._logger.create(`getItem('${t}')`),this._data[t]}setItem(t,e){this._logger.create(`setItem('${t}')`),this._data[t]=e}removeItem(t){this._logger.create(`removeItem('${t}')`),delete this._data[t]}get length(){return Object.getOwnPropertyNames(this._data).length}key(t){return Object.getOwnPropertyNames(this._data)[t]}},pr=class{constructor(t=[],e=null,r={}){this._jwtHandler=e,this._extraHeaders=r,this._logger=new I("JsonService"),this._contentTypes=[],this._contentTypes.push(...t,"application/json"),e&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(t,e={}){const{timeoutInSeconds:r,...n}=e;if(!r)return await fetch(t,n);const i=new AbortController,s=setTimeout(()=>i.abort(),r*1e3);try{return await fetch(t,{...e,signal:i.signal})}catch(a){throw a instanceof DOMException&&a.name==="AbortError"?new Zt("Network timed out"):a}finally{clearTimeout(s)}}async getJson(t,{token:e,credentials:r}={}){const n=this._logger.create("getJson"),i={Accept:this._contentTypes.join(", ")};e&&(n.debug("token passed, setting Authorization header"),i.Authorization="Bearer "+e),this.appendExtraHeaders(i);let s;try{n.debug("url:",t),s=await this.fetchWithTimeout(t,{method:"GET",headers:i,credentials:r})}catch(d){throw n.error("Network Error"),d}n.debug("HTTP response received, status",s.status);const a=s.headers.get("Content-Type");if(a&&!this._contentTypes.find(d=>a.startsWith(d))&&n.throw(new Error(`Invalid response Content-Type: ${a??"undefined"}, from URL: ${t}`)),s.ok&&this._jwtHandler&&(a!=null&&a.startsWith("application/jwt")))return await this._jwtHandler(await s.text());let c;try{c=await s.json()}catch(d){throw n.error("Error parsing JSON response",d),s.ok?d:new Error(`${s.statusText} (${s.status})`)}if(!s.ok)throw n.error("Error from server:",c),c.error?new Te(c):new Error(`${s.statusText} (${s.status}): ${JSON.stringify(c)}`);return c}async postForm(t,{body:e,basicAuth:r,timeoutInSeconds:n,initCredentials:i}){const s=this._logger.create("postForm"),a={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};r!==void 0&&(a.Authorization="Basic "+r),this.appendExtraHeaders(a);let c;try{s.debug("url:",t),c=await this.fetchWithTimeout(t,{method:"POST",headers:a,body:e,timeoutInSeconds:n,credentials:i})}catch(h){throw s.error("Network error"),h}s.debug("HTTP response received, status",c.status);const d=c.headers.get("Content-Type");if(d&&!this._contentTypes.find(h=>d.startsWith(h)))throw new Error(`Invalid response Content-Type: ${d??"undefined"}, from URL: ${t}`);const o=await c.text();let u={};if(o)try{u=JSON.parse(o)}catch(h){throw s.error("Error parsing JSON response",h),c.ok?h:new Error(`${c.statusText} (${c.status})`)}if(!c.ok)throw s.error("Error from server:",u),u.error?new Te(u,e):new Error(`${c.statusText} (${c.status}): ${JSON.stringify(u)}`);return u}appendExtraHeaders(t){const e=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),n=["authorization","accept","content-type"];r.length!==0&&r.forEach(i=>{if(n.includes(i.toLocaleLowerCase())){e.warn("Protected header could not be overridden",i,n);return}const s=typeof this._extraHeaders[i]=="function"?this._extraHeaders[i]():this._extraHeaders[i];s&&s!==""&&(t[i]=s)})}},Jr=class{constructor(t){this._settings=t,this._logger=new I("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new pr(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const t=this._logger.create("getMetadata");if(this._metadata)return t.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;t.debug("getting metadata from",this._metadataUrl);const e=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,e),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(t=!0){return this._getMetadataProperty("token_endpoint",t)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(t=!0){return this._getMetadataProperty("revocation_endpoint",t)}getKeysEndpoint(t=!0){return this._getMetadataProperty("jwks_uri",t)}async _getMetadataProperty(t,e=!1){const r=this._logger.create(`_getMetadataProperty('${t}')`),n=await this.getMetadata();if(r.debug("resolved"),n[t]===void 0){if(e===!0){r.warn("Metadata does not contain optional property");return}r.throw(new Error("Metadata does not contain property "+t))}return n[t]}async getSigningKeys(){const t=this._logger.create("getSigningKeys");if(this._signingKeys)return t.debug("returning signingKeys from cache"),this._signingKeys;const e=await this.getKeysEndpoint(!1);t.debug("got jwks_uri",e);const r=await this._jsonService.getJson(e);if(t.debug("got key set",r),!Array.isArray(r.keys))throw t.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}},_r=class{constructor({prefix:t="oidc.",store:e=localStorage}={}){this._logger=new I("WebStorageStateStore"),this._store=e,this._prefix=t}async set(t,e){this._logger.create(`set('${t}')`),t=this._prefix+t,await this._store.setItem(t,e)}async get(t){return this._logger.create(`get('${t}')`),t=this._prefix+t,await this._store.getItem(t)}async remove(t){this._logger.create(`remove('${t}')`),t=this._prefix+t;const e=await this._store.getItem(t);return await this._store.removeItem(t),e}async getAllKeys(){this._logger.create("getAllKeys");const t=await this._store.length,e=[];for(let r=0;r<t;r++){const n=await this._store.key(r);n&&n.indexOf(this._prefix)===0&&e.push(n.substr(this._prefix.length))}return e}},Jn="code",Kn="openid",Qn="client_secret_post",Gn="query",Yn=60*15,Xn=60*5,Tt=class{constructor({authority:t,metadataUrl:e,metadata:r,signingKeys:n,metadataSeed:i,client_id:s,client_secret:a,response_type:c=Jn,scope:d=Kn,redirect_uri:o,post_logout_redirect_uri:u,client_authentication:h=Qn,prompt:k,display:w,max_age:U,ui_locales:m,acr_values:_,resource:M,response_mode:l=Gn,filterProtocolClaims:g=!0,loadUserInfo:y=!1,staleStateAgeInSeconds:x=Yn,clockSkewInSeconds:P=Xn,userInfoJwtIssuer:N="OP",mergeClaims:A=!1,disablePKCE:L=!1,stateStore:J,refreshTokenCredentials:B,revokeTokenAdditionalContentTypes:te,fetchRequestCredentials:we,refreshTokenAllowedScope:Q,extraQueryParams:$e={},extraTokenParams:Re={},extraHeaders:_e={}}){if(this.authority=t,e?this.metadataUrl=e:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=i,this.signingKeys=n,this.client_id=s,this.client_secret=a,this.response_type=c,this.scope=d,this.redirect_uri=o,this.post_logout_redirect_uri=u,this.client_authentication=h,this.prompt=k,this.display=w,this.max_age=U,this.ui_locales=m,this.acr_values=_,this.resource=M,this.response_mode=l,this.filterProtocolClaims=g??!0,this.loadUserInfo=!!y,this.staleStateAgeInSeconds=x,this.clockSkewInSeconds=P,this.userInfoJwtIssuer=N,this.mergeClaims=!!A,this.disablePKCE=!!L,this.revokeTokenAdditionalContentTypes=te,we&&B&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=we||B||"same-origin",J)this.stateStore=J;else{const De=typeof window<"u"?window.localStorage:new gr;this.stateStore=new _r({store:De})}this.refreshTokenAllowedScope=Q,this.extraQueryParams=$e,this.extraTokenParams=Re,this.extraHeaders=_e}},es=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new I("UserInfoService"),this._getClaimsFromJwt=async r=>{const n=this._logger.create("_getClaimsFromJwt");try{const i=sr.decode(r);return n.debug("JWT decoding successful"),i}catch(i){throw n.error("Error parsing JWT response"),i}},this._jsonService=new pr(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(t){const e=this._logger.create("getClaims");t||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();e.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:t,credentials:this._settings.fetchRequestCredentials});return e.debug("got claims",n),n}},Kr=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new I("TokenClient"),this._jsonService=new pr(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode({grant_type:t="authorization_code",redirect_uri:e=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,...i}){const s=this._logger.create("exchangeCode");r||s.throw(new Error("A client_id is required")),e||s.throw(new Error("A redirect_uri is required")),i.code||s.throw(new Error("A code is required"));const a=new URLSearchParams({grant_type:t,redirect_uri:e});for(const[u,h]of Object.entries(i))h!=null&&a.set(u,h);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw s.throw(new Error("A client_secret is required")),null;c=fe.generateBasicAuth(r,n);break;case"client_secret_post":a.append("client_id",r),n&&a.append("client_secret",n);break}const d=await this._metadataService.getTokenEndpoint(!1);s.debug("got token endpoint");const o=await this._jsonService.postForm(d,{body:a,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return s.debug("got response"),o}async exchangeCredentials({grant_type:t="password",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...i}){const s=this._logger.create("exchangeCredentials");e||s.throw(new Error("A client_id is required"));const a=new URLSearchParams({grant_type:t,scope:n});for(const[u,h]of Object.entries(i))h!=null&&a.set(u,h);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw s.throw(new Error("A client_secret is required")),null;c=fe.generateBasicAuth(e,r);break;case"client_secret_post":a.append("client_id",e),r&&a.append("client_secret",r);break}const d=await this._metadataService.getTokenEndpoint(!1);s.debug("got token endpoint");const o=await this._jsonService.postForm(d,{body:a,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return s.debug("got response"),o}async exchangeRefreshToken({grant_type:t="refresh_token",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,...i}){const s=this._logger.create("exchangeRefreshToken");e||s.throw(new Error("A client_id is required")),i.refresh_token||s.throw(new Error("A refresh_token is required"));const a=new URLSearchParams({grant_type:t});for(const[u,h]of Object.entries(i))Array.isArray(h)?h.forEach(k=>a.append(u,k)):h!=null&&a.set(u,h);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw s.throw(new Error("A client_secret is required")),null;c=fe.generateBasicAuth(e,r);break;case"client_secret_post":a.append("client_id",e),r&&a.append("client_secret",r);break}const d=await this._metadataService.getTokenEndpoint(!1);s.debug("got token endpoint");const o=await this._jsonService.postForm(d,{body:a,basicAuth:c,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials});return s.debug("got response"),o}async revoke(t){var e;const r=this._logger.create("revoke");t.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${(e=t.token_type_hint)!=null?e:"default token type"}`);const i=new URLSearchParams;for(const[s,a]of Object.entries(t))a!=null&&i.set(s,a);i.set("client_id",this._settings.client_id),this._settings.client_secret&&i.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:i}),r.debug("got response")}},ts=class{constructor(t,e,r){this._settings=t,this._metadataService=e,this._claimsService=r,this._logger=new I("ResponseValidator"),this._userInfoService=new es(this._settings,this._metadataService),this._tokenClient=new Kr(this._settings,this._metadataService)}async validateSigninResponse(t,e){const r=this._logger.create("validateSigninResponse");this._processSigninState(t,e),r.debug("state processed"),await this._processCode(t,e),r.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),await this._processClaims(t,e==null?void 0:e.skipUserInfo,t.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(t,e){const r=this._logger.create("validateCredentialsResponse");t.isOpenId&&t.id_token&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),await this._processClaims(t,e,t.isOpenId),r.debug("claims processed")}async validateRefreshResponse(t,e){var r,n;const i=this._logger.create("validateRefreshResponse");t.userState=e.data,(r=t.session_state)!=null||(t.session_state=e.session_state),(n=t.scope)!=null||(t.scope=e.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,e.id_token),i.debug("ID Token validated")),t.id_token||(t.id_token=e.id_token,t.profile=e.profile);const s=t.isOpenId&&!!t.id_token;await this._processClaims(t,!1,s),i.debug("claims processed")}validateSignoutResponse(t,e){const r=this._logger.create("validateSignoutResponse");if(e.id!==t.state&&r.throw(new Error("State does not match")),r.debug("state validated"),t.userState=e.data,t.error)throw r.warn("Response was error",t.error),new Te(t)}_processSigninState(t,e){var r;const n=this._logger.create("_processSigninState");if(e.id!==t.state&&n.throw(new Error("State does not match")),e.client_id||n.throw(new Error("No client_id on state")),e.authority||n.throw(new Error("No authority on state")),this._settings.authority!==e.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==e.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),t.userState=e.data,t.url_state=e.url_state,(r=t.scope)!=null||(t.scope=e.scope),t.error)throw n.warn("Response was error",t.error),new Te(t);e.code_verifier&&!t.code&&n.throw(new Error("Expected code in response"))}async _processClaims(t,e=!1,r=!0){const n=this._logger.create("_processClaims");if(t.profile=this._claimsService.filterProtocolClaims(t.profile),e||!this._settings.loadUserInfo||!t.access_token){n.debug("not loading user info");return}n.debug("loading user info");const i=await this._userInfoService.getClaims(t.access_token);n.debug("user info claims received from user info endpoint"),r&&i.sub!==t.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._claimsService.mergeClaims(t.profile,this._claimsService.filterProtocolClaims(i)),n.debug("user info claims received, updated profile:",t.profile)}async _processCode(t,e){const r=this._logger.create("_processCode");if(t.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier,...e.extraTokenParams});Object.assign(t,n)}else r.debug("No code to process")}_validateIdTokenAttributes(t,e){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const i=sr.decode((r=t.id_token)!=null?r:"");if(i.sub||n.throw(new Error("ID Token is missing a subject claim")),e){const s=sr.decode(e);i.sub!==s.sub&&n.throw(new Error("sub in id_token does not match current sub")),i.auth_time&&i.auth_time!==s.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),i.azp&&i.azp!==s.azp&&n.throw(new Error("azp in id_token does not match original azp")),!i.azp&&s.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}t.profile=i}},je=class{constructor(t){this.id=t.id||fe.generateUUIDv4(),this.data=t.data,t.created&&t.created>0?this.created=t.created:this.created=ee.getEpochTime(),this.request_type=t.request_type,this.url_state=t.url_state}toStorageString(){return new I("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(t){return I.createStatic("State","fromStorageString"),new je(JSON.parse(t))}static async clearStaleState(t,e){const r=I.createStatic("State","clearStaleState"),n=ee.getEpochTime()-e,i=await t.getAllKeys();r.debug("got keys",i);for(let s=0;s<i.length;s++){const a=i[s],c=await t.get(a);let d=!1;if(c)try{const o=je.fromStorageString(c);r.debug("got item from key:",a,o.created),o.created<=n&&(d=!0)}catch(o){r.error("Error parsing state for key:",a,o),d=!0}else r.debug("no item in storage for key:",a),d=!0;d&&(r.debug("removed item for key:",a),t.remove(a))}}},Lt=class extends je{constructor(t){super(t),t.code_verifier===!0?this.code_verifier=fe.generateCodeVerifier():t.code_verifier&&(this.code_verifier=t.code_verifier),this.code_verifier&&(this.code_challenge=fe.generateCodeChallenge(this.code_verifier)),this.authority=t.authority,this.client_id=t.client_id,this.redirect_uri=t.redirect_uri,this.scope=t.scope,this.client_secret=t.client_secret,this.extraTokenParams=t.extraTokenParams,this.response_mode=t.response_mode,this.skipUserInfo=t.skipUserInfo}toStorageString(){return new I("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(t){I.createStatic("SigninState","fromStorageString");const e=JSON.parse(t);return new Lt(e)}},rs=class{constructor({url:t,authority:e,client_id:r,redirect_uri:n,response_type:i,scope:s,state_data:a,response_mode:c,request_type:d,client_secret:o,nonce:u,url_state:h,resource:k,skipUserInfo:w,extraQueryParams:U,extraTokenParams:m,disablePKCE:_,...M}){if(this._logger=new I("SigninRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!i)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!s)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!e)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new Lt({data:a,request_type:d,url_state:h,code_verifier:!_,client_id:r,authority:e,redirect_uri:n,response_mode:c,client_secret:o,scope:s,extraTokenParams:m,skipUserInfo:w});const l=new URL(t);l.searchParams.append("client_id",r),l.searchParams.append("redirect_uri",n),l.searchParams.append("response_type",i),l.searchParams.append("scope",s),u&&l.searchParams.append("nonce",u);let g=this.state.id;h&&(g=`${g}${ar}${h}`),l.searchParams.append("state",g),this.state.code_challenge&&(l.searchParams.append("code_challenge",this.state.code_challenge),l.searchParams.append("code_challenge_method","S256")),k&&(Array.isArray(k)?k:[k]).forEach(x=>l.searchParams.append("resource",x));for(const[y,x]of Object.entries({response_mode:c,...M,...U}))x!=null&&l.searchParams.append(y,x.toString());this.url=l.href}},ns="openid",St=class{constructor(t){if(this.access_token="",this.token_type="",this.profile={},this.state=t.get("state"),this.session_state=t.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(ar);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(ar))}this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri"),this.code=t.get("code")}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-ee.getEpochTime()}set expires_in(t){typeof t=="string"&&(t=Number(t)),t!==void 0&&t>=0&&(this.expires_at=Math.floor(t)+ee.getEpochTime())}get isOpenId(){var t;return((t=this.scope)==null?void 0:t.split(" ").includes(ns))||!!this.id_token}},ss=class{constructor({url:t,state_data:e,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:i,request_type:s,client_id:a}){if(this._logger=new I("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");const c=new URL(t);r&&c.searchParams.append("id_token_hint",r),a&&c.searchParams.append("client_id",a),n&&(c.searchParams.append("post_logout_redirect_uri",n),e&&(this.state=new je({data:e,request_type:s}),c.searchParams.append("state",this.state.id)));for(const[d,o]of Object.entries({...i}))o!=null&&c.searchParams.append(d,o.toString());this.url=c.href}},Qr=class{constructor(t){this.state=t.get("state"),this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri")}},is=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],as=["sub","iss","aud","exp","iat"],os=class{constructor(t){this._settings=t,this._logger=new I("ClaimsService")}filterProtocolClaims(t){const e={...t};if(this._settings.filterProtocolClaims){let r;Array.isArray(this._settings.filterProtocolClaims)?r=this._settings.filterProtocolClaims:r=is;for(const n of r)as.includes(n)||delete e[n]}return e}mergeClaims(t,e){const r={...t};for(const[n,i]of Object.entries(e))for(const s of Array.isArray(i)?i:[i]){const a=r[n];a===void 0?r[n]=s:Array.isArray(a)?a.includes(s)||a.push(s):r[n]!==s&&(typeof s=="object"&&this._settings.mergeClaims?r[n]=this.mergeClaims(a,s):r[n]=[a,s])}return r}},Gr=class{constructor(t,e){this._logger=new I("OidcClient"),this.settings=t instanceof Tt?t:new Tt(t),this.metadataService=e??new Jr(this.settings),this._claimsService=new os(this.settings),this._validator=new ts(this.settings,this.metadataService,this._claimsService),this._tokenClient=new Kr(this.settings,this.metadataService)}async createSigninRequest({state:t,request:e,request_uri:r,request_type:n,id_token_hint:i,login_hint:s,skipUserInfo:a,nonce:c,url_state:d,response_type:o=this.settings.response_type,scope:u=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:k=this.settings.prompt,display:w=this.settings.display,max_age:U=this.settings.max_age,ui_locales:m=this.settings.ui_locales,acr_values:_=this.settings.acr_values,resource:M=this.settings.resource,response_mode:l=this.settings.response_mode,extraQueryParams:g=this.settings.extraQueryParams,extraTokenParams:y=this.settings.extraTokenParams}){const x=this._logger.create("createSigninRequest");if(o!=="code")throw new Error("Only the Authorization Code flow (with PKCE) is supported");const P=await this.metadataService.getAuthorizationEndpoint();x.debug("Received authorization endpoint",P);const N=new rs({url:P,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:o,scope:u,state_data:t,url_state:d,prompt:k,display:w,max_age:U,ui_locales:m,id_token_hint:i,login_hint:s,acr_values:_,resource:M,request:e,request_uri:r,extraQueryParams:g,extraTokenParams:y,request_type:n,response_mode:l,client_secret:this.settings.client_secret,skipUserInfo:a,nonce:c,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const A=N.state;return await this.settings.stateStore.set(A.id,A.toStorageString()),N}async readSigninResponseState(t,e=!1){const r=this._logger.create("readSigninResponseState"),n=new St(ir.readParams(t,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const i=await this.settings.stateStore[e?"remove":"get"](n.state);if(!i)throw r.throw(new Error("No matching state found in storage")),null;return{state:Lt.fromStorageString(i),response:n}}async processSigninResponse(t){const e=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(t,!0);return e.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials({username:t,password:e,skipUserInfo:r=!1,extraTokenParams:n={}}){const i=await this._tokenClient.exchangeCredentials({username:t,password:e,...n}),s=new St(new URLSearchParams);return Object.assign(s,i),await this._validator.validateCredentialsResponse(s,r),s}async useRefreshToken({state:t,timeoutInSeconds:e}){var r;const n=this._logger.create("useRefreshToken");let i;if(this.settings.refreshTokenAllowedScope===void 0)i=t.scope;else{const c=this.settings.refreshTokenAllowedScope.split(" ");i=(((r=t.scope)==null?void 0:r.split(" "))||[]).filter(o=>c.includes(o)).join(" ")}const s=await this._tokenClient.exchangeRefreshToken({refresh_token:t.refresh_token,resource:t.resource,scope:i,timeoutInSeconds:e}),a=new St(new URLSearchParams);return Object.assign(a,s),n.debug("validating response",a),await this._validator.validateRefreshResponse(a,{...t,scope:i}),a}async createSignoutRequest({state:t,id_token_hint:e,client_id:r,request_type:n,post_logout_redirect_uri:i=this.settings.post_logout_redirect_uri,extraQueryParams:s=this.settings.extraQueryParams}={}){const a=this._logger.create("createSignoutRequest"),c=await this.metadataService.getEndSessionEndpoint();if(!c)throw a.throw(new Error("No end session endpoint")),null;a.debug("Received end session endpoint",c),!r&&i&&!e&&(r=this.settings.client_id);const d=new ss({url:c,id_token_hint:e,client_id:r,post_logout_redirect_uri:i,state_data:t,extraQueryParams:s,request_type:n});await this.clearStaleState();const o=d.state;return o&&(a.debug("Signout request has state to persist"),await this.settings.stateStore.set(o.id,o.toStorageString())),d}async readSignoutResponseState(t,e=!1){const r=this._logger.create("readSignoutResponseState"),n=new Qr(ir.readParams(t,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new Te(n);return{state:void 0,response:n}}const i=await this.settings.stateStore[e?"remove":"get"](n.state);if(!i)throw r.throw(new Error("No matching state found in storage")),null;return{state:je.fromStorageString(i),response:n}}async processSignoutResponse(t){const e=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(t,!0);return r?(e.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):e.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),je.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(t,e){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:t,token_type_hint:e})}},Yr=class{constructor(t){this._userManager=t,this._logger=new I("SessionMonitor"),this._start=async e=>{const r=e.session_state;if(!r)return;const n=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,n.debug("session_state",r,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,n.debug("session_state",r,", anonymous user")),this._checkSessionIFrame){this._checkSessionIFrame.start(r);return}try{const i=await this._userManager.metadataService.getCheckSessionIframe();if(i){n.debug("initializing check session iframe");const s=this._userManager.settings.client_id,a=this._userManager.settings.checkSessionIntervalInSeconds,c=this._userManager.settings.stopCheckSessionOnError,d=new Fr(this._callback,s,i,a,c);await d.load(),this._checkSessionIFrame=d,d.start(r)}else n.warn("no check session iframe found in the metadata")}catch(i){n.error("Error from getCheckSessionIframe:",i instanceof Error?i.message:i)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const r=setInterval(async()=>{clearInterval(r);try{const n=await this._userManager.querySessionStatus();if(n){const i={session_state:n.session_state,profile:n.sub&&n.sid?{sub:n.sub,sid:n.sid}:null};this._start(i)}}catch(n){e.error("error from querySessionStatus",n instanceof Error?n.message:n)}},1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const r=await this._userManager.querySessionStatus();let n=!0;r&&this._checkSessionIFrame?r.sub===this._sub?(n=!1,this._checkSessionIFrame.start(r.session_state),r.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",r.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",r.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",r.sub):e.debug("subject no longer signed into OP"),n?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(r){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",r),this._userManager.events._raiseUserSignedOut())}},t||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch(e=>{this._logger.error(e)})}async _init(){this._logger.create("_init");const t=await this._userManager.getUser();if(t)this._start(t);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const r={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(r)}}}},rt=class{constructor(t){var e;this.id_token=t.id_token,this.session_state=(e=t.session_state)!=null?e:null,this.access_token=t.access_token,this.refresh_token=t.refresh_token,this.token_type=t.token_type,this.scope=t.scope,this.profile=t.profile,this.expires_at=t.expires_at,this.state=t.userState,this.url_state=t.url_state}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-ee.getEpochTime()}set expires_in(t){t!==void 0&&(this.expires_at=Math.floor(t)+ee.getEpochTime())}get expired(){const t=this.expires_in;if(t!==void 0)return t<=0}get scopes(){var t,e;return(e=(t=this.scope)==null?void 0:t.split(" "))!=null?e:[]}toStorageString(){return new I("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(t){return I.createStatic("User","fromStorageString"),new rt(JSON.parse(t))}},br="oidc-client",Xr=class{constructor(){this._abort=new ke("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(t){const e=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");e.debug("setting URL in window"),this._window.location.replace(t.url);const{url:r,keepOpen:n}=await new Promise((i,s)=>{const a=c=>{var d;const o=c.data,u=(d=t.scriptOrigin)!=null?d:window.location.origin;if(!(c.origin!==u||(o==null?void 0:o.source)!==br)){try{const h=ir.readParams(o.url,t.response_mode).get("state");if(h||e.warn("no state found in response url"),c.source!==this._window&&h!==t.state)return}catch{this._dispose(),s(new Error("Invalid response from window"))}i(o)}};window.addEventListener("message",a,!1),this._disposeHandlers.add(()=>window.removeEventListener("message",a,!1)),this._disposeHandlers.add(this._abort.addHandler(c=>{this._dispose(),s(c)}))});return e.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const t of this._disposeHandlers)t();this._disposeHandlers.clear()}static _notifyParent(t,e,r=!1,n=window.location.origin){t.postMessage({source:br,url:e,keepOpen:r},n)}},en={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},tn="_blank",cs=60,ds=2,rn=10,nn=class extends Tt{constructor(t){const{popup_redirect_uri:e=t.redirect_uri,popup_post_logout_redirect_uri:r=t.post_logout_redirect_uri,popupWindowFeatures:n=en,popupWindowTarget:i=tn,redirectMethod:s="assign",redirectTarget:a="self",iframeNotifyParentOrigin:c=t.iframeNotifyParentOrigin,iframeScriptOrigin:d=t.iframeScriptOrigin,silent_redirect_uri:o=t.redirect_uri,silentRequestTimeoutInSeconds:u=rn,automaticSilentRenew:h=!0,validateSubOnSilentRenew:k=!0,includeIdTokenInSilentRenew:w=!1,monitorSession:U=!1,monitorAnonymousSession:m=!1,checkSessionIntervalInSeconds:_=ds,query_status_response_type:M="code",stopCheckSessionOnError:l=!0,revokeTokenTypes:g=["access_token","refresh_token"],revokeTokensOnSignout:y=!1,includeIdTokenInSilentSignout:x=!1,accessTokenExpiringNotificationTimeInSeconds:P=cs,userStore:N}=t;if(super(t),this.popup_redirect_uri=e,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=i,this.redirectMethod=s,this.redirectTarget=a,this.iframeNotifyParentOrigin=c,this.iframeScriptOrigin=d,this.silent_redirect_uri=o,this.silentRequestTimeoutInSeconds=u,this.automaticSilentRenew=h,this.validateSubOnSilentRenew=k,this.includeIdTokenInSilentRenew=w,this.monitorSession=U,this.monitorAnonymousSession=m,this.checkSessionIntervalInSeconds=_,this.stopCheckSessionOnError=l,this.query_status_response_type=M,this.revokeTokenTypes=g,this.revokeTokensOnSignout=y,this.includeIdTokenInSilentSignout=x,this.accessTokenExpiringNotificationTimeInSeconds=P,N)this.userStore=N;else{const A=typeof window<"u"?window.sessionStorage:new gr;this.userStore=new _r({store:A})}}},or=class extends Xr{constructor({silentRequestTimeoutInSeconds:t=rn}){super(),this._logger=new I("IFrameWindow"),this._timeoutInSeconds=t,this._frame=or.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const t=window.document.createElement("iframe");return t.style.visibility="hidden",t.style.position="fixed",t.style.left="-1000px",t.style.top="0",t.width="0",t.height="0",window.document.body.appendChild(t),t}async navigate(t){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const e=setTimeout(()=>this._abort.raise(new Zt("IFrame timed out without a response")),this._timeoutInSeconds*1e3);return this._disposeHandlers.add(()=>clearTimeout(e)),await super.navigate(t)}close(){var t;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",e=>{var r;const n=e.target;(r=n.parentNode)==null||r.removeChild(n),this._abort.raise(new Error("IFrame removed from DOM"))},!0),(t=this._frame.contentWindow)==null||t.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(t,e){return super._notifyParent(window.parent,t,!1,e)}},us=class{constructor(t){this._settings=t,this._logger=new I("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:t=this._settings.silentRequestTimeoutInSeconds}){return new or({silentRequestTimeoutInSeconds:t})}async callback(t){this._logger.create("callback"),or.notifyParent(t,this._settings.iframeNotifyParentOrigin)}},ls=500,hs=1e3,kr=class extends Xr{constructor({popupWindowTarget:t=tn,popupWindowFeatures:e={}}){super(),this._logger=new I("PopupWindow");const r=wr.center({...en,...e});this._window=window.open(void 0,t,wr.serialize(r)),e.closePopupWindowAfterInSeconds&&e.closePopupWindowAfterInSeconds>0&&setTimeout(()=>{if(!this._window||typeof this._window.closed!="boolean"||this._window.closed){this._abort.raise(new Error("Popup blocked by user"));return}this.close()},e.closePopupWindowAfterInSeconds*hs)}async navigate(t){var e;(e=this._window)==null||e.focus();const r=setInterval(()=>{(!this._window||this._window.closed)&&this._abort.raise(new Error("Popup closed by user"))},ls);return this._disposeHandlers.add(()=>clearInterval(r)),await super.navigate(t)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(t,e){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,t,e)}},fs=class{constructor(t){this._settings=t,this._logger=new I("PopupNavigator")}async prepare({popupWindowFeatures:t=this._settings.popupWindowFeatures,popupWindowTarget:e=this._settings.popupWindowTarget}){return new kr({popupWindowFeatures:t,popupWindowTarget:e})}async callback(t,{keepOpen:e=!1}){this._logger.create("callback"),kr.notifyOpener(t,e)}},gs=class{constructor(t){this._settings=t,this._logger=new I("RedirectNavigator")}async prepare({redirectMethod:t=this._settings.redirectMethod,redirectTarget:e=this._settings.redirectTarget}){var r;this._logger.create("prepare");let n=window.self;e==="top"&&(n=(r=window.top)!=null?r:window.self);const i=n.location[t].bind(n.location);let s;return{navigate:async a=>{this._logger.create("navigate");const c=new Promise((d,o)=>{s=o});return i(a.url),await c},close:()=>{this._logger.create("close"),s==null||s(new Error("Redirect aborted")),n.stop()}}}async callback(){}},ps=class extends Vr{constructor(t){super({expiringNotificationTimeInSeconds:t.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new I("UserManagerEvents"),this._userLoaded=new ke("User loaded"),this._userUnloaded=new ke("User unloaded"),this._silentRenewError=new ke("Silent renew error"),this._userSignedIn=new ke("User signed in"),this._userSignedOut=new ke("User signed out"),this._userSessionChanged=new ke("User session changed")}load(t,e=!0){super.load(t),e&&this._userLoaded.raise(t)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(t){return this._userLoaded.addHandler(t)}removeUserLoaded(t){return this._userLoaded.removeHandler(t)}addUserUnloaded(t){return this._userUnloaded.addHandler(t)}removeUserUnloaded(t){return this._userUnloaded.removeHandler(t)}addSilentRenewError(t){return this._silentRenewError.addHandler(t)}removeSilentRenewError(t){return this._silentRenewError.removeHandler(t)}_raiseSilentRenewError(t){this._silentRenewError.raise(t)}addUserSignedIn(t){return this._userSignedIn.addHandler(t)}removeUserSignedIn(t){this._userSignedIn.removeHandler(t)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(t){return this._userSignedOut.addHandler(t)}removeUserSignedOut(t){this._userSignedOut.removeHandler(t)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(t){return this._userSessionChanged.addHandler(t)}removeUserSessionChanged(t){this._userSessionChanged.removeHandler(t)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},_s=class{constructor(t){this._userManager=t,this._logger=new I("SilentRenewService"),this._isStarted=!1,this._retryTimer=new ee("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(r){if(r instanceof Zt){e.warn("ErrorTimeout from signinSilent:",r,"retry in 5s"),this._retryTimer.init(5);return}e.error("Error from signinSilent:",r),this._userManager.events._raiseSilentRenewError(r)}}}async start(){const t=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(e){t.error("getUser error",e)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}},vs=class{constructor(t,e){this.refresh_token=t.refresh_token,this.id_token=t.id_token,this.session_state=t.session_state,this.scope=t.scope,this.profile=t.profile,this.resource=e,this.data=t.state}},ms=class{constructor(t,e,r,n){this._logger=new I("UserManager"),this.settings=new nn(t),this._client=new Gr(t),this._redirectNavigator=e??new gs(this.settings),this._popupNavigator=r??new fs(this.settings),this._iframeNavigator=n??new us(this.settings),this._events=new ps(this.settings),this._silentRenewService=new _s(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new Yr(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const t=this._logger.create("getUser"),e=await this._loadUser();return e?(t.info("user loaded"),this._events.load(e,!1),e):(t.info("user not found in storage"),null)}async removeUser(){const t=this._logger.create("removeUser");await this.storeUser(null),t.info("user removed from storage"),this._events.unload()}async signinRedirect(t={}){this._logger.create("signinRedirect");const{redirectMethod:e,...r}=t,n=await this._redirectNavigator.prepare({redirectMethod:e});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(t=window.location.href){const e=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(t);return r.profile&&r.profile.sub?e.info("success, signed in subject",r.profile.sub):e.info("no subject"),r}async signinResourceOwnerCredentials({username:t,password:e,skipUserInfo:r=!1}){const n=this._logger.create("signinResourceOwnerCredential"),i=await this._client.processResourceOwnerPasswordCredentials({username:t,password:e,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});n.debug("got signin response");const s=await this._buildUser(i);return s.profile&&s.profile.sub?n.info("success, signed in subject",s.profile.sub):n.info("no subject"),s}async signinPopup(t={}){const e=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...i}=t,s=this.settings.popup_redirect_uri;s||e.throw(new Error("No popup_redirect_uri configured"));const a=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),c=await this._signin({request_type:"si:p",redirect_uri:s,display:"popup",...i},a);return c&&(c.profile&&c.profile.sub?e.info("success, signed in subject",c.profile.sub):e.info("no subject")),c}async signinPopupCallback(t=window.location.href,e=!1){const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(t,{keepOpen:e}),r.info("success")}async signinSilent(t={}){var e;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,resource:i,...s}=t;let a=await this._loadUser();if(a!=null&&a.refresh_token){r.debug("using refresh token");const u=new vs(a,i);return await this._useRefreshToken(u)}const c=this.settings.silent_redirect_uri;c||r.throw(new Error("No silent_redirect_uri configured"));let d;a&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",a.profile.sub),d=a.profile.sub);const o=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return a=await this._signin({request_type:"si:s",redirect_uri:c,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?a==null?void 0:a.id_token:void 0,...s},o,d),a&&((e=a.profile)!=null&&e.sub?r.info("success, signed in subject",a.profile.sub):r.info("no subject")),a}async _useRefreshToken(t){const e=await this._client.useRefreshToken({state:t,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new rt({...t,...e});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(t=window.location.href){const e=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(t),e.info("success")}async signinCallback(t=window.location.href){const{state:e}=await this._client.readSigninResponseState(t);switch(e.request_type){case"si:r":return await this.signinRedirectCallback(t);case"si:p":return await this.signinPopupCallback(t);case"si:s":return await this.signinSilentCallback(t);default:throw new Error("invalid response_type in state")}}async signoutCallback(t=window.location.href,e=!1){const{state:r}=await this._client.readSignoutResponseState(t);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(t);break;case"so:p":await this.signoutPopupCallback(t,e);break;case"so:s":await this.signoutSilentCallback(t);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(t={}){const e=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=t,i=this.settings.silent_redirect_uri;i||e.throw(new Error("No silent_redirect_uri configured"));const s=await this._loadUser(),a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),c=await this._signinStart({request_type:"si:s",redirect_uri:i,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?s==null?void 0:s.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},a);try{const d=await this._client.processSigninResponse(c.url);return e.debug("got signin response"),d.session_state&&d.profile.sub?(e.info("success for subject",d.profile.sub),{session_state:d.session_state,sub:d.profile.sub,sid:d.profile.sid}):(e.info("success, user not authenticated"),null)}catch(d){if(this.settings.monitorAnonymousSession&&d instanceof Te)switch(d.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return e.info("success for anonymous user"),{session_state:d.session_state}}throw d}}async _signin(t,e,r){const n=await this._signinStart(t,e);return await this._signinEnd(n.url,r)}async _signinStart(t,e){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(t);return r.debug("got signin request"),await e.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(n){throw r.debug("error after preparing navigator, closing navigator window"),e.close(),n}}async _signinEnd(t,e){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(t);return r.debug("got signin response"),await this._buildUser(n,e)}async _buildUser(t,e){const r=this._logger.create("_buildUser"),n=new rt(t);if(e){if(e!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new Te({...t,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(t={}){const e=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=t,i=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},i),e.info("success")}async signoutRedirectCallback(t=window.location.href){const e=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(t);return e.info("success"),r}async signoutPopup(t={}){const e=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...i}=t,s=this.settings.popup_post_logout_redirect_uri,a=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:s,state:s==null?void 0:{},...i},a),e.info("success")}async signoutPopupCallback(t=window.location.href,e=!1){const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(t,{keepOpen:e}),r.info("success")}async _signout(t,e){const r=await this._signoutStart(t,e);return await this._signoutEnd(r.url)}async _signoutStart(t={},e){var r;const n=this._logger.create("_signoutStart");try{const i=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(i);const s=t.id_token_hint||i&&i.id_token;s&&(n.debug("setting id_token_hint in signout request"),t.id_token_hint=s),await this.removeUser(),n.debug("user removed, creating signout request");const a=await this._client.createSignoutRequest(t);return n.debug("got signout request"),await e.navigate({url:a.url,state:(r=a.state)==null?void 0:r.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(i){throw n.debug("error after preparing navigator, closing navigator window"),e.close(),i}}async _signoutEnd(t){const e=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(t);return e.debug("got signout response"),r}async signoutSilent(t={}){var e;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...i}=t,s=this.settings.includeIdTokenInSilentSignout?(e=await this._loadUser())==null?void 0:e.id_token:void 0,a=this.settings.popup_post_logout_redirect_uri,c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:a,id_token_hint:s,...i},c),r.info("success")}async signoutSilentCallback(t=window.location.href){const e=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(t),e.info("success")}async revokeTokens(t){const e=await this._loadUser();await this._revokeInternal(e,t)}async _revokeInternal(t,e=this.settings.revokeTokenTypes){const r=this._logger.create("_revokeInternal");if(!t)return;const n=e.filter(i=>typeof t[i]=="string");if(!n.length){r.debug("no need to revoke due to no token(s)");return}for(const i of n)await this._client.revokeToken(t[i],i),r.info(`${i} revoked successfully`),i!=="access_token"&&(t[i]=null);await this.storeUser(t),r.debug("user stored"),this._events.load(t)}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const t=this._logger.create("_loadUser"),e=await this.settings.userStore.get(this._userStoreKey);return e?(t.debug("user storageString loaded"),rt.fromStorageString(e)):(t.debug("no user storageString"),null)}async storeUser(t){const e=this._logger.create("storeUser");if(t){e.debug("storing user");const r=t.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}},ys="2.4.0",ws=ys,$t={},bs=T&&T.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($t,"__esModule",{value:!0});$t.readExpirationTimeInJwt=void 0;var ks=bs(fr),Ss=vt();function xs(t){var e;try{e=(0,ks.default)(t).exp*1e3,(0,Ss.assert)(typeof e=="number"&&!isNaN(e))}catch{return}return e}$t.readExpirationTimeInJwt=xs;var xe={},Sr=T&&T.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s};Object.defineProperty(xe,"__esModule",{value:!0});xe.retrieveQueryParamFromUrl=xe.retrieveAllQueryParamStartingWithPrefixFromUrl=xe.addQueryParamToUrl=void 0;function Ts(t){var e=t.url,r=t.name,n=t.value,i=e,s=an({url:e,name:r});return s.wasPresent&&(i=s.newUrl),i+="".concat(i.includes("?")?"&":i.endsWith("?")?"":"?").concat(r,"=").concat(encodeURIComponent(n)),{newUrl:i}}xe.addQueryParamToUrl=Ts;function sn(t){var e=t.url,r=t.prefix,n=t.doLeavePrefixInResults,i=Sr(e.split("?"),2),s=i[0],a=i[1],c=a===void 0?"":a,d={},o=function(){var u=c.replace(/^\?/,"").split("&").map(function(h){return h.split("=")}).filter(function(h){var k=Sr(h,2),w=k[0],U=k[1];return w.startsWith(r)?(d[n?w:w.substring(r.length)]=decodeURIComponent(U),!1):!0}).map(function(h){return h.join("=")}).join("&");return u=u===""?"":"?".concat(u),{newLocationSearch:u}}().newLocationSearch;return{newUrl:"".concat(s).concat(o),values:d}}xe.retrieveAllQueryParamStartingWithPrefixFromUrl=sn;function an(t){var e=t.url,r=t.name,n=sn({url:e,prefix:r,doLeavePrefixInResults:!0}),i=n.newUrl,s=n.values;return r in s?{wasPresent:!0,newUrl:i,value:s[r]}:{wasPresent:!1}}xe.retrieveQueryParamFromUrl=an;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.fnv1aHashToHex=void 0;function Is(t){for(var e=2166136261,r=0;r<t.length;r++)e^=t.charCodeAt(r),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return(e>>>0).toString(16)}Dt.fnv1aHashToHex=Is;var Ne={},Es=T&&T.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ne,"__esModule",{value:!0});Ne.VoidDeferred=Ne.Deferred=void 0;var xr=bn(),on=function(){function t(){var e=this;this.isPending=!0;var r,n;this.pr=new Promise(function(i,s){r=function(a){(0,xr.overwriteReadonlyProp)(e,"isPending",!1),i(a)},n=function(a){(0,xr.overwriteReadonlyProp)(e,"isPending",!1),s(a)}}),this.resolve=r,this.reject=n}return t}();Ne.Deferred=on;var Cs=function(t){Es(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(on);Ne.VoidDeferred=Cs;var qt={},Rs=T&&T.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(qt,"__esModule",{value:!0});qt.decodeJwt=void 0;var Os=Rs(fr);qt.decodeJwt=Os.default;var Ht={},Us=T&&T.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.getDownlinkAndRtt=void 0;var Tr=vt();function Ps(){var t,e;if(window.navigator instanceof Object){var r=window.navigator;try{for(var n=Us(["connection","mozConnection","webkitConnection"]),i=n.next();!i.done;i=n.next()){var s=i.value;try{var a=r[s],c=a.downlink,d=a.rtt;return(0,Tr.assert)(typeof c=="number"),(0,Tr.assert)(typeof d=="number"),{downlink:c,rtt:d}}catch{}}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}}Ht.getDownlinkAndRtt=Ps;var Bt={},zt={};Object.defineProperty(zt,"__esModule",{value:!0});zt.createStatefulObservable=void 0;function As(t){var e=[],r=function(){var s=void 0;return{get:function(){return s===void 0&&(s=[t()]),s[0]},set:function(a){s=[a],e.forEach(function(c){return c(a)})}}}(),n=r.get,i=r.set;return Object.defineProperty({current:null,subscribe:function(s){return e.push(s),{unsubscribe:function(){return e.splice(e.indexOf(s),1)}}}},"current",{enumerable:!0,get:n,set:i})}zt.createStatefulObservable=As;var Wt={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.getPrUserInteraction=void 0;var js=Ne;function Ns(){var t=new js.Deferred,e=function(){t.resolve(),r()},r=function(){window.document.removeEventListener("mousemove",e,!1),window.document.removeEventListener("keydown",e,!1)};return window.document.addEventListener("mousemove",e,!1),window.document.addEventListener("keydown",e,!1),{prUserInteraction:t.pr,cancelPrUserInteraction:r}}Vt.getPrUserInteraction=Ns;var Ms=T&&T.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(u){try{o(n.next(u))}catch(h){a(h)}}function d(u){try{o(n.throw(u))}catch(h){a(h)}}function o(u){u.done?s(u.value):i(u.value).then(c,d)}o((n=n.apply(t,e||[])).next())})},Zs=T&&T.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(o){return function(u){return d([o,u])}}function d(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(u){o=[6,u],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.subscribeToUserInteraction=void 0;var Ls=Vt;function $s(t){var e=t.throttleMs,r=new Set;(function i(){return Ms(this,void 0,void 0,function(){var s,a,c;return Zs(this,function(d){switch(d.label){case 0:return s=(0,Ls.getPrUserInteraction)(),a=s.cancelPrUserInteraction,c=s.prUserInteraction,r.add(a),[4,c];case 1:return d.sent(),t.callback(),[4,new Promise(function(o){var u=setTimeout(o,e);r.add(function(){clearTimeout(u)})})];case 2:return d.sent(),r.clear(),i(),[2]}})})})();var n=function(){Array.from(r).forEach(function(i){return i()})};return{unsubscribeFromUserInteraction:n}}Wt.subscribeToUserInteraction=$s;Object.defineProperty(Bt,"__esModule",{value:!0});Bt.createIsUserActive=void 0;var Ds=zt,qs=Wt,Hs=vt();function Bs(t){var e=t.theUserIsConsideredInactiveAfterMsOfInactivity,r=(0,Ds.createStatefulObservable)(function(){return!0}),n=function(){var c=setTimeout(function(){(0,Hs.assert)(r.current),r.current=!1},e);return function(){clearTimeout(c)}},i=n(),s=(0,qs.subscribeToUserInteraction)({throttleMs:1e3,callback:function(){i(),i=n(),r.current||(r.current=!0)}}).unsubscribeFromUserInteraction,a=function(){s(),i()};return{$isUserActive:r,disable$isUserActive:a}}Bt.createIsUserActive=Bs;var Ft={},zs=T&&T.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(u){try{o(n.next(u))}catch(h){a(h)}}function d(u){try{o(n.throw(u))}catch(h){a(h)}}function o(u){u.done?s(u.value):i(u.value).then(c,d)}o((n=n.apply(t,e||[])).next())})},Ws=T&&T.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(o){return function(u){return d([o,u])}}function d(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(u){o=[6,u],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.createStartCountdown=void 0;function Vs(t){var e=t.getCountdownEndTime,r=t.tickCallback,n=function(){return e()-Date.now()};function i(){var s=this,a;(function(){return zs(s,void 0,void 0,function(){var d;return Ws(this,function(o){switch(o.label){case 0:d=Math.floor(n()/1e3),o.label=1;case 1:return d>=0?(r({secondsLeft:d}),[4,new Promise(function(u){a=setTimeout(u,1e3)})]):[3,3];case 2:return o.sent(),d--,[3,1];case 3:return[2]}})})})();var c=function(){clearTimeout(a),r({secondsLeft:void 0})};return{stopCountdown:c}}return{startCountdown:i}}Ft.createStartCountdown=Vs;var Fs=T&&T.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),he=T&&T.__assign||function(){return he=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},he.apply(this,arguments)},Ue=T&&T.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(u){try{o(n.next(u))}catch(h){a(h)}}function d(u){try{o(n.throw(u))}catch(h){a(h)}}function o(u){u.done?s(u.value):i(u.value).then(c,d)}o((n=n.apply(t,e||[])).next())})},Pe=T&&T.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(o){return function(u){return d([o,u])}}function d(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(u){o=[6,u],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Gt=T&&T.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Ir=T&&T.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Er=T&&T.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.createOidc=Fe.OidcInitializationError=void 0;var Js=qn,Yt=Lr,Cr=$t,ne=vt(),de=xe,Ks=Dt,Qs=Ne,Gs=qt,Ys=Ht,Xs=Bt,ei=Ft,He=function(t){Fs(e,t);function e(r){var n=this.constructor,i=t.call(this,function(){switch(r.type){case"server down":return"The OIDC server is down";case"bad configuration":return"Bad configuration. Timed out after ".concat(r.timeoutDelayMs,"ms");case"unknown":return r.cause.message}}(),{cause:r.type==="unknown"?r.cause:void 0})||this;return i.type=r.type,Object.setPrototypeOf(i,n.prototype),i}return e}(Error);Fe.OidcInitializationError=He;var Rr=["code","state","session_state","iss"],Xt=void 0,er=new Map;function ti(t){return Ue(this,void 0,void 0,function(){var e,r,n,i,s,a,c,d,o,u,h,k,w,U,m,_,M,l,g,y,x,P,N,A,L,J,B,te,we,Q,$e,Re,_e=this;return Pe(this,function(De){switch(De.label){case 0:return e=t.issuerUri,r=t.clientId,n=t.clientSecret,i=t.transformUrlBeforeRedirect,s=i===void 0?function(O){return O}:i,a=t.extraQueryParams,c=t.publicUrl,d=t.decodedIdTokenSchema,o=t.__unsafe_ssoSessionIdleSeconds,u=function(){if(typeof a=="function")return a;if(a!==void 0)return function(){return a}}(),h=function(){return c===void 0?window.location.origin:(c.startsWith("http")?c:"".concat(window.location.origin).concat(c)).replace(/\/$/,"")}(),k=(0,Ks.fnv1aHashToHex)("".concat(e," ").concat(r)),w=er.get(k),w!==void 0&&Array.from(w??[]).forEach(function(O){return O()}),er.set(k,new Set),U="configHash",m=new Js.UserManager({authority:e,client_id:r,client_secret:n,redirect_uri:"",response_type:"code",scope:"openid profile",automaticSilentRenew:!1,silent_redirect_uri:"".concat(h,"/silent-sso.html?").concat(U,"=").concat(k)}),_=void 0,M=function(){var O=history.pushState.bind(history);history.pushState=function(){for(var H=[],q=0;q<arguments.length;q++)H[q]=arguments[q];return _=window.location.href,O.apply(void 0,Ir([],Gt(H),!1))}},l=!1,g=function(O){var Z=O.doesCurrentHrefRequiresAuth,H=O.extraQueryParams;return Ue(_e,void 0,void 0,function(){function q(){for(var Y=[],ve=0;ve<arguments.length;ve++)Y[ve]=arguments[ve];var qe=new(G.bind.apply(G,Ir([void 0],Gt(Y),!1)));return new Proxy(qe,{get:function(Qe,re){if(re==="href"){var W=qe.href;return Object.entries(he(he({},u==null?void 0:u()),H)).forEach(function(Ge){var Ye=Gt(Ge,2),K=Ye[0],X=Ye[1];return W=(0,de.addQueryParamToUrl)({url:W,name:K,value:X}).newUrl}),W=s(W),W}return Qe[re]}})}var G,$,Oe;return Pe(this,function(Y){switch(Y.label){case 0:return l?[2,new Promise(function(){})]:(l=!0,G=window.URL,Object.defineProperty(window,"URL",{value:q}),$=(0,de.addQueryParamToUrl)({url:window.location.href,name:U,value:k}).newUrl,Z&&(Oe=function(){document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",Oe),_!==void 0?window.location.href=_:window.history.back())},document.addEventListener("visibilitychange",Oe)),[4,m.signinRedirect({redirect_uri:$,redirectMethod:Z?"replace":"assign"})]);case 1:return Y.sent(),[2,new Promise(function(){})]}})})},[4,function(){return Ue(this,void 0,void 0,function(){var Z,$,$,re,H,q,G,$,W,W,Oe,Y,ve,qe,Qe,re,W,Ge,Ye;return Pe(this,function(K){switch(K.label){case 0:Z=window.location.href;{if($=(0,de.retrieveQueryParamFromUrl)({name:U,url:Z}),!$.wasPresent||$.value!==k)return[3,5];Z=$.newUrl}if($=(0,de.retrieveQueryParamFromUrl)({name:"error",url:Z}),$.wasPresent)throw new Error("OIDC error: ".concat($.value));re="https://dummy.com";try{for(H=Er(Rr),q=H.next();!q.done;q=H.next()){if(G=q.value,$=(0,de.retrieveQueryParamFromUrl)({name:G,url:Z}),!$.wasPresent){if(G==="iss")continue;throw new Error("Missing query param: ".concat(G))}re=(0,de.addQueryParamToUrl)({url:re,name:G,value:$.value}).newUrl,Z=$.newUrl}}catch(X){Ge={error:X}}finally{try{q&&!q.done&&(Ye=H.return)&&Ye.call(H)}finally{if(Ge)throw Ge.error}}window.history.pushState(null,"",Z),W=void 0,K.label=1;case 1:return K.trys.push([1,3,,4]),[4,m.signinRedirectCallback(re)];case 2:return W=K.sent(),[3,4];case 3:return K.sent(),[2,void 0];case 4:return[2,{loginScenario:"backFromLoginPages",oidcClientTsUser:W}];case 5:return[4,m.getUser()];case 6:if(W=K.sent(),W===null)return[3,11];K.label=7;case 7:return K.trys.push([7,9,,10]),[4,m.signinSilent()];case 8:return K.sent(),[3,10];case 9:if(Oe=K.sent(),(0,ne.assert)(Oe instanceof Error),Oe.message==="Failed to fetch")throw new He({type:"server down"});return[2,void 0];case 10:return[2,{loginScenario:"sessionStorageRestoration",oidcClientTsUser:W}];case 11:return Y=new Qs.Deferred,ve=function(){var X=(0,Ys.getDownlinkAndRtt)();if(X===void 0)return 5e3;var Xe=X.downlink,wt=X.rtt,et=3e3,ce=wt*2.5+3e3/(Xe+1);return Math.max(et,ce)}(),qe=setTimeout(function(){return Y.reject(new He({type:"bad configuration",timeoutDelayMs:ve}))},ve),Qe=function(X){var Xe,wt;if(typeof X.data=="string"){var et=X.data;{var ce=void 0;try{ce=(0,de.retrieveQueryParamFromUrl)({name:U,url:et})}catch{return}if(!ce.wasPresent||ce.value!==k)return}clearTimeout(qe),window.removeEventListener("message",Qe);{var ce=(0,de.retrieveQueryParamFromUrl)({name:"error",url:et});if(ce.wasPresent){Y.resolve(void 0);return}}var Qt="https://dummy.com";try{for(var bt=Er(Rr),tt=bt.next();!tt.done;tt=bt.next()){var kt=tt.value,ce=(0,de.retrieveQueryParamFromUrl)({name:kt,url:et});if(!ce.wasPresent){if(kt==="iss")continue;throw new Error("Missing query param: ".concat(kt))}Qt=(0,de.addQueryParamToUrl)({url:Qt,name:kt,value:ce.value}).newUrl}}catch(vr){Xe={error:vr}}finally{try{tt&&!tt.done&&(wt=bt.return)&&wt.call(bt)}finally{if(Xe)throw Xe.error}}Y.resolve(Qt)}},window.addEventListener("message",Qe,!1),m.signinSilent({silentRequestTimeoutInSeconds:ve/1e3}).catch(function(X){X.message==="Failed to fetch"&&(clearTimeout(qe),Y.reject(new He({type:"server down"})))}),[4,Y.pr];case 12:return re=K.sent(),re===void 0?[3,14]:[4,m.signinRedirectCallback(re)];case 13:return W=K.sent(),[2,{loginScenario:"silentSignin",oidcClientTsUser:W}];case 14:return[2,void 0]}})})}().then(function(O){if(O!==void 0){var Z=O.oidcClientTsUser,H=O.loginScenario,q=Or({oidcClientTsUser:Z,decodedIdTokenSchema:d});return q.refreshTokenExpirationTime<q.accessTokenExpirationTime&&console.warn(["The OIDC refresh token shorter than the one of the access token.","This is very unusual and probably a misconfiguration.","Check your oidc server configuration for ".concat(r," ").concat(e)].join(" ")),{tokens:q,loginScenario:H}}},function(O){return(0,ne.assert)(O instanceof Error),O})];case 1:return y=De.sent(),x={params:{issuerUri:e,clientId:r}},y instanceof Error?(P=y,N=P instanceof He?P:new He({type:"unknown",cause:P}),console.error("OIDC initialization error: ".concat(N.message)),M(),[2,(0,Yt.id)(he(he({},x),{isUserLoggedIn:!1,login:function(){return Ue(_e,void 0,void 0,function(){return Pe(this,function(O){return alert("Authentication is currently unavailable. Please try again later."),[2,new Promise(function(){})]})})},initializationError:N}))]):y===void 0?(M(),[2,(0,Yt.id)(he(he({},x),{isUserLoggedIn:!1,login:g,initializationError:void 0}))]):(A=y.tokens,L=new Set,J=new Set,B=(0,Yt.id)(he(he({},x),{isUserLoggedIn:!0,getTokens:function(){return A},logout:function(O){return Ue(_e,void 0,void 0,function(){return Pe(this,function(Z){switch(Z.label){case 0:return[4,m.signoutRedirect({post_logout_redirect_uri:function(){switch(O.redirectTo){case"current page":return window.location.href;case"home":return h;case"specific url":return O.url}(0,ne.assert)(!1)}()})];case 1:return Z.sent(),[2,new Promise(function(){})]}})})},renewTokens:function(){return Ue(_e,void 0,void 0,function(){var O,Z;return Pe(this,function(H){switch(H.label){case 0:return[4,m.signinSilent()];case 1:return O=H.sent(),(0,ne.assert)(O!==null),Z=Object.getOwnPropertyDescriptor(A,"decodedIdToken"),(0,ne.assert)(Z!==void 0),A=Or({oidcClientTsUser:O,decodedIdTokenSchema:d}),Object.defineProperty(A,"decodedIdToken",Z),Array.from(J).forEach(function(q){return q()}),[2]}})})},subscribeToTokensChange:function(O){return J.add(O),{unsubscribe:function(){J.delete(O)}}},subscribeToAutoLogoutCountdown:function(O){L.add(O);var Z=function(){L.delete(O)};return{unsubscribeFromAutoLogoutCountdown:Z}},loginScenario:y.loginScenario})),te=function(){var O=Math.min(A.accessTokenExpirationTime,A.refreshTokenExpirationTime);return O-Date.now()},function O(){var Z=this,H=Math.min(25e3,te()*.1),q=setTimeout(function(){return Ue(Z,void 0,void 0,function(){return Pe(this,function($){switch($.label){case 0:G(),$.label=1;case 1:return $.trys.push([1,3,,5]),[4,B.renewTokens()];case 2:return $.sent(),[3,5];case 3:return $.sent(),[4,g({doesCurrentHrefRequiresAuth:!1})];case 4:return $.sent(),[3,5];case 5:return O(),[2]}})})},te()-H),G=B.subscribeToTokensChange(function(){clearTimeout(q),G(),O()}).unsubscribe}(),we=(0,ei.createStartCountdown)({getCountdownEndTime:function(){return o??A.refreshTokenExpirationTime},tickCallback:function(O){var Z=O.secondsLeft;Array.from(L).forEach(function(H){return H({secondsLeft:Z})}),Z===0&&B.logout({redirectTo:"current page"})}}).startCountdown,Q=void 0,Xt===void 0&&(Xt=(0,Xs.createIsUserActive)({theUserIsConsideredInactiveAfterMsOfInactivity:5e3}).$isUserActive),$e=Xt.subscribe(function(O){O?Q!==void 0&&(Q(),Q=void 0):((0,ne.assert)(Q===void 0),Q=we().stopCountdown)}).unsubscribe,Re=er.get(k),(0,ne.assert)(Re!==void 0),Re.add(function(){$e(),Q==null||Q()}),[2,B])}})})}Fe.createOidc=ti;function Or(t){var e=t.oidcClientTsUser,r=t.decodedIdTokenSchema,n=e.access_token,i=function(){e:{var u=e.expires_at;if(u===void 0)break e;return u*1e3}e:{var h=(0,Cr.readExpirationTimeInJwt)(n);if(h===void 0)break e;return h}(0,ne.assert)(!1,"Failed to get access token expiration time")}(),s=e.refresh_token;(0,ne.assert)(s!==void 0,"No refresh token provided by the oidc server");var a=function(){e:{var u=(0,Cr.readExpirationTimeInJwt)(s);if(u===void 0)break e;return u}(0,ne.assert)(!1,"Failed to get refresh token expiration time")}(),c=e.id_token;(0,ne.assert)(c!==void 0,"No id token provided by the oidc server");var d={accessToken:n,accessTokenExpirationTime:i,refreshToken:s,refreshTokenExpirationTime:a,idToken:c,decodedIdToken:null},o=void 0;return Object.defineProperty(d,"decodedIdToken",{get:function(){if(o!==void 0&&o.idToken===this.idToken)return o.decodedIdToken;var u=(0,Gs.decodeJwt)(this.idToken);return r!==void 0&&(u=r.parse(u)),o={idToken:this.idToken,decodedIdToken:u},u},configurable:!0,enumerable:!0}),d}var Jt={},ri=T&&T.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},ni=T&&T.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.useGuaranteedMemo=void 0;var si=$r;function ii(t,e){var r=(0,si.useRef)();return(!r.current||e.length!==r.current.prevDeps.length||r.current.prevDeps.map(function(n,i){return n===e[i]}).indexOf(!1)>=0)&&(r.current={v:t(),prevDeps:ni([],ri(e),!1)}),r.current.v}Jt.useGuaranteedMemo=ii;var We=T&&T.__assign||function(){return We=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},We.apply(this,arguments)},Ur=T&&T.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s};Object.defineProperty(hr,"__esModule",{value:!0});var cn=hr.createReactOidc=void 0,tr=z,Be=$r,ai=Fe,Pr=vt(),Ar=Lr,oi=Jt,jr=(0,Be.createContext)(void 0);function ci(t){var e=(0,ai.createOidc)(t),r=t.decodedIdTokenSchema;function n(s){var a=s.children,c=s.fallback,d=Ur((0,Be.useState)(void 0),2),o=d[0],u=d[1];return(0,Be.useEffect)(function(){e.then(u)},[]),o===void 0?(0,tr.jsx)(tr.Fragment,{children:c===void 0?null:c}):(0,tr.jsx)(jr.Provider,{value:{oidc:o,decodedIdTokenSchema:r},children:a})}function i(s){var a=(s??{}).assertUserLoggedIn,c=a===void 0?!1:a,d=function(){var _=(0,Be.useContext)(jr);return(0,Pr.assert)(_!==void 0,"You must use useOidc inside a OidcProvider"),_}(),o=d.oidc,u=d.decodedIdTokenSchema,h=Ur((0,Be.useReducer)(function(){return[]},[]),2),k=h[1];if((0,Be.useEffect)(function(){if(o.isUserLoggedIn){var m=o.subscribeToTokensChange(k).unsubscribe;return m}},[o]),c&&!o.isUserLoggedIn)throw new Error("The user must be logged in to use this hook (assertUserLoggedIn was set to true)");var w=function(){var _=o.isUserLoggedIn?o.getTokens():void 0,M=(0,oi.useGuaranteedMemo)(function(){if(_!==void 0){var l={accessToken:_.accessToken,accessTokenExpirationTime:_.accessTokenExpirationTime,idToken:_.idToken,refreshToken:_.refreshToken,refreshTokenExpirationTime:_.refreshTokenExpirationTime,decodedIdToken:null},g=void 0;return Object.defineProperty(l,"decodedIdToken",{get:function(){if(g!==void 0)return g.decodedIdToken;var y=_.decodedIdToken;return r!==void 0&&r!==u&&(y=r.parse(y)),g={decodedIdToken:y},y}}),l}},[_==null?void 0:_.accessToken,_==null?void 0:_.accessTokenExpirationTime,_==null?void 0:_.idToken,_==null?void 0:_.refreshToken,_==null?void 0:_.refreshTokenExpirationTime]);return{oidcTokens:M}}().oidcTokens,U={params:o.params};return o.isUserLoggedIn?(0,Ar.id)(((0,Pr.assert)(w!==void 0),We(We({},U),{isUserLoggedIn:!0,oidcTokens:w,logout:o.logout,renewTokens:o.renewTokens,subscribeToAutoLogoutCountdown:o.subscribeToAutoLogoutCountdown}))):(0,Ar.id)(We(We({},U),{isUserLoggedIn:!1,login:o.login,initializationError:o.initializationError}))}return{OidcProvider:n,useOidc:i,prOidc:e}}cn=hr.createReactOidc=ci;var j;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(c=>typeof i[i[c]]!="number"),a={};for(const c of s)a[c]=i[c];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(j||(j={}));var cr;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(cr||(cr={}));const p=j.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Se=t=>{switch(typeof t){case"undefined":return p.undefined;case"string":return p.string;case"number":return isNaN(t)?p.nan:p.number;case"boolean":return p.boolean;case"function":return p.function;case"bigint":return p.bigint;case"symbol":return p.symbol;case"object":return Array.isArray(t)?p.array:t===null?p.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?p.promise:typeof Map<"u"&&t instanceof Map?p.map:typeof Set<"u"&&t instanceof Set?p.set:typeof Date<"u"&&t instanceof Date?p.date:p.object;default:return p.unknown}},f=j.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),di=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class ie extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(s){return s.message},n={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else{let c=n,d=0;for(;d<a.path.length;){const o=a.path[d];d===a.path.length-1?(c[o]=c[o]||{_errors:[]},c[o]._errors.push(r(a))):c[o]=c[o]||{_errors:[]},c=c[o],d++}}};return i(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,j.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}ie.create=t=>new ie(t);const it=(t,e)=>{let r;switch(t.code){case f.invalid_type:t.received===p.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case f.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,j.jsonStringifyReplacer)}`;break;case f.unrecognized_keys:r=`Unrecognized key(s) in object: ${j.joinValues(t.keys,", ")}`;break;case f.invalid_union:r="Invalid input";break;case f.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${j.joinValues(t.options)}`;break;case f.invalid_enum_value:r=`Invalid enum value. Expected ${j.joinValues(t.options)}, received '${t.received}'`;break;case f.invalid_arguments:r="Invalid function arguments";break;case f.invalid_return_type:r="Invalid function return type";break;case f.invalid_date:r="Invalid date";break;case f.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:j.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case f.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case f.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case f.custom:r="Invalid input";break;case f.invalid_intersection_types:r="Intersection results could not be merged";break;case f.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case f.not_finite:r="Number must be finite";break;default:r=e.defaultError,j.assertNever(t)}return{message:r}};let dn=it;function ui(t){dn=t}function It(){return dn}const Et=t=>{const{data:e,path:r,errorMaps:n,issueData:i}=t,s=[...r,...i.path||[]],a={...i,path:s};let c="";const d=n.filter(o=>!!o).slice().reverse();for(const o of d)c=o(a,{data:e,defaultError:c}).message;return{...i,path:s,message:i.message||c}},li=[];function v(t,e){const r=Et({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,It(),it].filter(n=>!!n)});t.common.issues.push(r)}class V{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const i of r){if(i.status==="aborted")return E;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const i of r)n.push({key:await i.key,value:await i.value});return V.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const i of r){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return E;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(n[s.value]=a.value)}return{status:e.value,value:n}}}const E=Object.freeze({status:"aborted"}),un=t=>({status:"dirty",value:t}),F=t=>({status:"valid",value:t}),dr=t=>t.status==="aborted",ur=t=>t.status==="dirty",at=t=>t.status==="valid",Ct=t=>typeof Promise<"u"&&t instanceof Promise;var b;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(b||(b={}));class ge{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Nr=(t,e)=>{if(at(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new ie(t.common.issues);return this._error=r,this._error}}};function C(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,c)=>a.code!=="invalid_type"?{message:c.defaultError}:typeof c.data>"u"?{message:n??c.defaultError}:{message:r??c.defaultError},description:i}}class R{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Se(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Se(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new V,ctx:{common:e.parent.common,data:e.data,parsedType:Se(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Ct(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const i={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Se(e)},s=this._parseSync({data:e,path:i.path,parent:i});return Nr(i,s)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Se(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(Ct(i)?i:Promise.resolve(i));return Nr(n,s)}refine(e,r){const n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,s)=>{const a=e(i),c=()=>s.addIssue({code:f.custom,...n(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(d=>d?!0:(c(),!1)):a?!0:(c(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new oe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return me.create(this,this._def)}nullable(){return Le.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ae.create(this,this._def)}promise(){return Ke.create(this,this._def)}or(e){return ut.create([this,e],this._def)}and(e){return lt.create(this,e,this._def)}transform(e){return new oe({...C(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new _t({...C(this._def),innerType:this,defaultValue:r,typeName:S.ZodDefault})}brand(){return new hn({typeName:S.ZodBranded,type:this,...C(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new Pt({...C(this._def),innerType:this,catchValue:r,typeName:S.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return yt.create(this,e)}readonly(){return jt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const hi=/^c[^\s-]{8,}$/i,fi=/^[a-z][a-z0-9]*$/,gi=/^[0-9A-HJKMNP-TV-Z]{26}$/,pi=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,_i=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,vi="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let rr;const mi=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,yi=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,wi=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function bi(t,e){return!!((e==="v4"||!e)&&mi.test(t)||(e==="v6"||!e)&&yi.test(t))}class se extends R{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==p.string){const s=this._getOrReturnCtx(e);return v(s,{code:f.invalid_type,expected:p.string,received:s.parsedType}),E}const n=new V;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),v(i,{code:f.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),v(i,{code:f.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,c=e.data.length<s.value;(a||c)&&(i=this._getOrReturnCtx(e,i),a?v(i,{code:f.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):c&&v(i,{code:f.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")_i.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"email",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")rr||(rr=new RegExp(vi,"u")),rr.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"emoji",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")pi.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"uuid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")hi.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"cuid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")fi.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"cuid2",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")gi.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"ulid",code:f.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),v(i,{validation:"url",code:f.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"regex",code:f.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),v(i,{code:f.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),v(i,{code:f.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),v(i,{code:f.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?wi(s).test(e.data)||(i=this._getOrReturnCtx(e,i),v(i,{code:f.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="ip"?bi(e.data,s.version)||(i=this._getOrReturnCtx(e,i),v(i,{validation:"ip",code:f.invalid_string,message:s.message}),n.dirty()):j.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:f.invalid_string,...b.errToObj(n)})}_addCheck(e){return new se({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...b.errToObj(e)})}url(e){return this._addCheck({kind:"url",...b.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...b.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...b.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...b.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...b.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...b.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...b.errToObj(e)})}datetime(e){var r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,...b.errToObj(e==null?void 0:e.message)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...b.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...b.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...b.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...b.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...b.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...b.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...b.errToObj(r)})}nonempty(e){return this.min(1,b.errToObj(e))}trim(){return new se({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new se({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new se({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}se.create=t=>{var e;return new se({checks:[],typeName:S.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...C(t)})};function ki(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,s=parseInt(t.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class Ie extends R{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==p.number){const s=this._getOrReturnCtx(e);return v(s,{code:f.invalid_type,expected:p.number,received:s.parsedType}),E}let n;const i=new V;for(const s of this._def.checks)s.kind==="int"?j.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),v(n,{code:f.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),v(n,{code:f.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),v(n,{code:f.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?ki(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),v(n,{code:f.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),v(n,{code:f.not_finite,message:s.message}),i.dirty()):j.assertNever(s);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,b.toString(r))}gt(e,r){return this.setLimit("min",e,!1,b.toString(r))}lte(e,r){return this.setLimit("max",e,!0,b.toString(r))}lt(e,r){return this.setLimit("max",e,!1,b.toString(r))}setLimit(e,r,n,i){return new Ie({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:b.toString(i)}]})}_addCheck(e){return new Ie({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:b.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:b.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:b.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:b.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:b.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:b.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:b.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:b.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:b.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&j.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Ie.create=t=>new Ie({checks:[],typeName:S.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...C(t)});class Ee extends R{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==p.bigint){const s=this._getOrReturnCtx(e);return v(s,{code:f.invalid_type,expected:p.bigint,received:s.parsedType}),E}let n;const i=new V;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),v(n,{code:f.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),v(n,{code:f.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),v(n,{code:f.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):j.assertNever(s);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,b.toString(r))}gt(e,r){return this.setLimit("min",e,!1,b.toString(r))}lte(e,r){return this.setLimit("max",e,!0,b.toString(r))}lt(e,r){return this.setLimit("max",e,!1,b.toString(r))}setLimit(e,r,n,i){return new Ee({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:b.toString(i)}]})}_addCheck(e){return new Ee({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:b.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:b.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:b.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:b.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:b.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Ee.create=t=>{var e;return new Ee({checks:[],typeName:S.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...C(t)})};class ot extends R{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==p.boolean){const n=this._getOrReturnCtx(e);return v(n,{code:f.invalid_type,expected:p.boolean,received:n.parsedType}),E}return F(e.data)}}ot.create=t=>new ot({typeName:S.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...C(t)});class Me extends R{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==p.date){const s=this._getOrReturnCtx(e);return v(s,{code:f.invalid_type,expected:p.date,received:s.parsedType}),E}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return v(s,{code:f.invalid_date}),E}const n=new V;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),v(i,{code:f.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),v(i,{code:f.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):j.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Me({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:b.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:b.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Me.create=t=>new Me({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:S.ZodDate,...C(t)});class Rt extends R{_parse(e){if(this._getType(e)!==p.symbol){const n=this._getOrReturnCtx(e);return v(n,{code:f.invalid_type,expected:p.symbol,received:n.parsedType}),E}return F(e.data)}}Rt.create=t=>new Rt({typeName:S.ZodSymbol,...C(t)});class ct extends R{_parse(e){if(this._getType(e)!==p.undefined){const n=this._getOrReturnCtx(e);return v(n,{code:f.invalid_type,expected:p.undefined,received:n.parsedType}),E}return F(e.data)}}ct.create=t=>new ct({typeName:S.ZodUndefined,...C(t)});class dt extends R{_parse(e){if(this._getType(e)!==p.null){const n=this._getOrReturnCtx(e);return v(n,{code:f.invalid_type,expected:p.null,received:n.parsedType}),E}return F(e.data)}}dt.create=t=>new dt({typeName:S.ZodNull,...C(t)});class Je extends R{constructor(){super(...arguments),this._any=!0}_parse(e){return F(e.data)}}Je.create=t=>new Je({typeName:S.ZodAny,...C(t)});class Ae extends R{constructor(){super(...arguments),this._unknown=!0}_parse(e){return F(e.data)}}Ae.create=t=>new Ae({typeName:S.ZodUnknown,...C(t)});class ye extends R{_parse(e){const r=this._getOrReturnCtx(e);return v(r,{code:f.invalid_type,expected:p.never,received:r.parsedType}),E}}ye.create=t=>new ye({typeName:S.ZodNever,...C(t)});class Ot extends R{_parse(e){if(this._getType(e)!==p.undefined){const n=this._getOrReturnCtx(e);return v(n,{code:f.invalid_type,expected:p.void,received:n.parsedType}),E}return F(e.data)}}Ot.create=t=>new Ot({typeName:S.ZodVoid,...C(t)});class ae extends R{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==p.array)return v(r,{code:f.invalid_type,expected:p.array,received:r.parsedType}),E;if(i.exactLength!==null){const a=r.data.length>i.exactLength.value,c=r.data.length<i.exactLength.value;(a||c)&&(v(r,{code:a?f.too_big:f.too_small,minimum:c?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(v(r,{code:f.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(v(r,{code:f.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,c)=>i.type._parseAsync(new ge(r,a,r.path,c)))).then(a=>V.mergeArray(n,a));const s=[...r.data].map((a,c)=>i.type._parseSync(new ge(r,a,r.path,c)));return V.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new ae({...this._def,minLength:{value:e,message:b.toString(r)}})}max(e,r){return new ae({...this._def,maxLength:{value:e,message:b.toString(r)}})}length(e,r){return new ae({...this._def,exactLength:{value:e,message:b.toString(r)}})}nonempty(e){return this.min(1,e)}}ae.create=(t,e)=>new ae({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...C(e)});function ze(t){if(t instanceof D){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=me.create(ze(n))}return new D({...t._def,shape:()=>e})}else return t instanceof ae?new ae({...t._def,type:ze(t.element)}):t instanceof me?me.create(ze(t.unwrap())):t instanceof Le?Le.create(ze(t.unwrap())):t instanceof pe?pe.create(t.items.map(e=>ze(e))):t}class D extends R{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=j.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==p.object){const o=this._getOrReturnCtx(e);return v(o,{code:f.invalid_type,expected:p.object,received:o.parsedType}),E}const{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),c=[];if(!(this._def.catchall instanceof ye&&this._def.unknownKeys==="strip"))for(const o in i.data)a.includes(o)||c.push(o);const d=[];for(const o of a){const u=s[o],h=i.data[o];d.push({key:{status:"valid",value:o},value:u._parse(new ge(i,h,i.path,o)),alwaysSet:o in i.data})}if(this._def.catchall instanceof ye){const o=this._def.unknownKeys;if(o==="passthrough")for(const u of c)d.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(o==="strict")c.length>0&&(v(i,{code:f.unrecognized_keys,keys:c}),n.dirty());else if(o!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const o=this._def.catchall;for(const u of c){const h=i.data[u];d.push({key:{status:"valid",value:u},value:o._parse(new ge(i,h,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const o=[];for(const u of d){const h=await u.key;o.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return o}).then(o=>V.mergeObjectSync(n,o)):V.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(e){return b.errToObj,new D({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var i,s,a,c;const d=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(c=b.errToObj(e).message)!==null&&c!==void 0?c:d}:{message:d}}}:{}})}strip(){return new D({...this._def,unknownKeys:"strip"})}passthrough(){return new D({...this._def,unknownKeys:"passthrough"})}extend(e){return new D({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new D({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:S.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new D({...this._def,catchall:e})}pick(e){const r={};return j.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new D({...this._def,shape:()=>r})}omit(e){const r={};return j.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new D({...this._def,shape:()=>r})}deepPartial(){return ze(this)}partial(e){const r={};return j.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}),new D({...this._def,shape:()=>r})}required(e){const r={};return j.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof me;)s=s._def.innerType;r[n]=s}}),new D({...this._def,shape:()=>r})}keyof(){return ln(j.objectKeys(this.shape))}}D.create=(t,e)=>new D({shape:()=>t,unknownKeys:"strip",catchall:ye.create(),typeName:S.ZodObject,...C(e)});D.strictCreate=(t,e)=>new D({shape:()=>t,unknownKeys:"strict",catchall:ye.create(),typeName:S.ZodObject,...C(e)});D.lazycreate=(t,e)=>new D({shape:t,unknownKeys:"strip",catchall:ye.create(),typeName:S.ZodObject,...C(e)});class ut extends R{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function i(s){for(const c of s)if(c.result.status==="valid")return c.result;for(const c of s)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;const a=s.map(c=>new ie(c.ctx.common.issues));return v(r,{code:f.invalid_union,unionErrors:a}),E}if(r.common.async)return Promise.all(n.map(async s=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const d of n){const o={...r,common:{...r.common,issues:[]},parent:null},u=d._parseSync({data:r.data,path:r.path,parent:o});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:o}),o.common.issues.length&&a.push(o.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;const c=a.map(d=>new ie(d));return v(r,{code:f.invalid_union,unionErrors:c}),E}}get options(){return this._def.options}}ut.create=(t,e)=>new ut({options:t,typeName:S.ZodUnion,...C(e)});const xt=t=>t instanceof ft?xt(t.schema):t instanceof oe?xt(t.innerType()):t instanceof gt?[t.value]:t instanceof Ce?t.options:t instanceof pt?Object.keys(t.enum):t instanceof _t?xt(t._def.innerType):t instanceof ct?[void 0]:t instanceof dt?[null]:null;class Kt extends R{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==p.object)return v(r,{code:f.invalid_type,expected:p.object,received:r.parsedType}),E;const n=this.discriminator,i=r.data[n],s=this.optionsMap.get(i);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(v(r,{code:f.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),E)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const i=new Map;for(const s of r){const a=xt(s.shape[e]);if(!a)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of a){if(i.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);i.set(c,s)}}return new Kt({typeName:S.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:i,...C(n)})}}function lr(t,e){const r=Se(t),n=Se(e);if(t===e)return{valid:!0,data:t};if(r===p.object&&n===p.object){const i=j.objectKeys(e),s=j.objectKeys(t).filter(c=>i.indexOf(c)!==-1),a={...t,...e};for(const c of s){const d=lr(t[c],e[c]);if(!d.valid)return{valid:!1};a[c]=d.data}return{valid:!0,data:a}}else if(r===p.array&&n===p.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],c=e[s],d=lr(a,c);if(!d.valid)return{valid:!1};i.push(d.data)}return{valid:!0,data:i}}else return r===p.date&&n===p.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class lt extends R{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=(s,a)=>{if(dr(s)||dr(a))return E;const c=lr(s.value,a.value);return c.valid?((ur(s)||ur(a))&&r.dirty(),{status:r.value,value:c.data}):(v(n,{code:f.invalid_intersection_types}),E)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}lt.create=(t,e,r)=>new lt({left:t,right:e,typeName:S.ZodIntersection,...C(r)});class pe extends R{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.array)return v(n,{code:f.invalid_type,expected:p.array,received:n.parsedType}),E;if(n.data.length<this._def.items.length)return v(n,{code:f.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),E;!this._def.rest&&n.data.length>this._def.items.length&&(v(n,{code:f.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const s=[...n.data].map((a,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new ge(n,a,n.path,c)):null}).filter(a=>!!a);return n.common.async?Promise.all(s).then(a=>V.mergeArray(r,a)):V.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new pe({...this._def,rest:e})}}pe.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pe({items:t,typeName:S.ZodTuple,rest:null,...C(e)})};class ht extends R{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.object)return v(n,{code:f.invalid_type,expected:p.object,received:n.parsedType}),E;const i=[],s=this._def.keyType,a=this._def.valueType;for(const c in n.data)i.push({key:s._parse(new ge(n,c,n.path,c)),value:a._parse(new ge(n,n.data[c],n.path,c))});return n.common.async?V.mergeObjectAsync(r,i):V.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof R?new ht({keyType:e,valueType:r,typeName:S.ZodRecord,...C(n)}):new ht({keyType:se.create(),valueType:e,typeName:S.ZodRecord,...C(r)})}}class Ut extends R{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.map)return v(n,{code:f.invalid_type,expected:p.map,received:n.parsedType}),E;const i=this._def.keyType,s=this._def.valueType,a=[...n.data.entries()].map(([c,d],o)=>({key:i._parse(new ge(n,c,n.path,[o,"key"])),value:s._parse(new ge(n,d,n.path,[o,"value"]))}));if(n.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of a){const o=await d.key,u=await d.value;if(o.status==="aborted"||u.status==="aborted")return E;(o.status==="dirty"||u.status==="dirty")&&r.dirty(),c.set(o.value,u.value)}return{status:r.value,value:c}})}else{const c=new Map;for(const d of a){const o=d.key,u=d.value;if(o.status==="aborted"||u.status==="aborted")return E;(o.status==="dirty"||u.status==="dirty")&&r.dirty(),c.set(o.value,u.value)}return{status:r.value,value:c}}}}Ut.create=(t,e,r)=>new Ut({valueType:e,keyType:t,typeName:S.ZodMap,...C(r)});class Ze extends R{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.set)return v(n,{code:f.invalid_type,expected:p.set,received:n.parsedType}),E;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(v(n,{code:f.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(v(n,{code:f.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const s=this._def.valueType;function a(d){const o=new Set;for(const u of d){if(u.status==="aborted")return E;u.status==="dirty"&&r.dirty(),o.add(u.value)}return{status:r.value,value:o}}const c=[...n.data.values()].map((d,o)=>s._parse(new ge(n,d,n.path,o)));return n.common.async?Promise.all(c).then(d=>a(d)):a(c)}min(e,r){return new Ze({...this._def,minSize:{value:e,message:b.toString(r)}})}max(e,r){return new Ze({...this._def,maxSize:{value:e,message:b.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Ze.create=(t,e)=>new Ze({valueType:t,minSize:null,maxSize:null,typeName:S.ZodSet,...C(e)});class Ve extends R{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==p.function)return v(r,{code:f.invalid_type,expected:p.function,received:r.parsedType}),E;function n(c,d){return Et({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,It(),it].filter(o=>!!o),issueData:{code:f.invalid_arguments,argumentsError:d}})}function i(c,d){return Et({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,It(),it].filter(o=>!!o),issueData:{code:f.invalid_return_type,returnTypeError:d}})}const s={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof Ke){const c=this;return F(async function(...d){const o=new ie([]),u=await c._def.args.parseAsync(d,s).catch(w=>{throw o.addIssue(n(d,w)),o}),h=await Reflect.apply(a,this,u);return await c._def.returns._def.type.parseAsync(h,s).catch(w=>{throw o.addIssue(i(h,w)),o})})}else{const c=this;return F(function(...d){const o=c._def.args.safeParse(d,s);if(!o.success)throw new ie([n(d,o.error)]);const u=Reflect.apply(a,this,o.data),h=c._def.returns.safeParse(u,s);if(!h.success)throw new ie([i(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ve({...this._def,args:pe.create(e).rest(Ae.create())})}returns(e){return new Ve({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new Ve({args:e||pe.create([]).rest(Ae.create()),returns:r||Ae.create(),typeName:S.ZodFunction,...C(n)})}}class ft extends R{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}ft.create=(t,e)=>new ft({getter:t,typeName:S.ZodLazy,...C(e)});class gt extends R{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return v(r,{received:r.data,code:f.invalid_literal,expected:this._def.value}),E}return{status:"valid",value:e.data}}get value(){return this._def.value}}gt.create=(t,e)=>new gt({value:t,typeName:S.ZodLiteral,...C(e)});function ln(t,e){return new Ce({values:t,typeName:S.ZodEnum,...C(e)})}class Ce extends R{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return v(r,{expected:j.joinValues(n),received:r.parsedType,code:f.invalid_type}),E}if(this._def.values.indexOf(e.data)===-1){const r=this._getOrReturnCtx(e),n=this._def.values;return v(r,{received:r.data,code:f.invalid_enum_value,options:n}),E}return F(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e){return Ce.create(e)}exclude(e){return Ce.create(this.options.filter(r=>!e.includes(r)))}}Ce.create=ln;class pt extends R{_parse(e){const r=j.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==p.string&&n.parsedType!==p.number){const i=j.objectValues(r);return v(n,{expected:j.joinValues(i),received:n.parsedType,code:f.invalid_type}),E}if(r.indexOf(e.data)===-1){const i=j.objectValues(r);return v(n,{received:n.data,code:f.invalid_enum_value,options:i}),E}return F(e.data)}get enum(){return this._def.values}}pt.create=(t,e)=>new pt({values:t,typeName:S.ZodNativeEnum,...C(e)});class Ke extends R{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==p.promise&&r.common.async===!1)return v(r,{code:f.invalid_type,expected:p.promise,received:r.parsedType}),E;const n=r.parsedType===p.promise?r.data:Promise.resolve(r.data);return F(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Ke.create=(t,e)=>new Ke({type:t,typeName:S.ZodPromise,...C(e)});class oe extends R{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===S.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{v(n,a),a.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(n.data,s);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(a).then(c=>this._def.schema._parseAsync({data:c,path:n.path,parent:n})):this._def.schema._parseSync({data:a,path:n.path,parent:n})}if(i.type==="refinement"){const a=c=>{const d=i.refinement(c,s);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?E:(c.status==="dirty"&&r.dirty(),a(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?E:(c.status==="dirty"&&r.dirty(),a(c.value).then(()=>({status:r.value,value:c.value}))))}if(i.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!at(a))return a;const c=i.transform(a.value,s);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>at(a)?Promise.resolve(i.transform(a.value,s)).then(c=>({status:r.value,value:c})):a);j.assertNever(i)}}oe.create=(t,e,r)=>new oe({schema:t,typeName:S.ZodEffects,effect:e,...C(r)});oe.createWithPreprocess=(t,e,r)=>new oe({schema:e,effect:{type:"preprocess",transform:t},typeName:S.ZodEffects,...C(r)});class me extends R{_parse(e){return this._getType(e)===p.undefined?F(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}me.create=(t,e)=>new me({innerType:t,typeName:S.ZodOptional,...C(e)});class Le extends R{_parse(e){return this._getType(e)===p.null?F(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Le.create=(t,e)=>new Le({innerType:t,typeName:S.ZodNullable,...C(e)});class _t extends R{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===p.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}_t.create=(t,e)=>new _t({innerType:t,typeName:S.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...C(e)});class Pt extends R{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ct(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ie(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ie(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Pt.create=(t,e)=>new Pt({innerType:t,typeName:S.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...C(e)});class At extends R{_parse(e){if(this._getType(e)!==p.nan){const n=this._getOrReturnCtx(e);return v(n,{code:f.invalid_type,expected:p.nan,received:n.parsedType}),E}return{status:"valid",value:e.data}}}At.create=t=>new At({typeName:S.ZodNaN,...C(t)});const Si=Symbol("zod_brand");class hn extends R{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class yt extends R{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?E:s.status==="dirty"?(r.dirty(),un(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?E:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new yt({in:e,out:r,typeName:S.ZodPipeline})}}class jt extends R{_parse(e){const r=this._def.innerType._parse(e);return at(r)&&(r.value=Object.freeze(r.value)),r}}jt.create=(t,e)=>new jt({innerType:t,typeName:S.ZodReadonly,...C(e)});const fn=(t,e={},r)=>t?Je.create().superRefine((n,i)=>{var s,a;if(!t(n)){const c=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,d=(a=(s=c.fatal)!==null&&s!==void 0?s:r)!==null&&a!==void 0?a:!0,o=typeof c=="string"?{message:c}:c;i.addIssue({code:"custom",...o,fatal:d})}}):Je.create(),xi={object:D.lazycreate};var S;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(S||(S={}));const Ti=(t,e={message:`Input not instance of ${t.name}`})=>fn(r=>r instanceof t,e),gn=se.create,pn=Ie.create,Ii=At.create,Ei=Ee.create,_n=ot.create,Ci=Me.create,Ri=Rt.create,Oi=ct.create,Ui=dt.create,Pi=Je.create,Ai=Ae.create,ji=ye.create,Ni=Ot.create,Mi=ae.create,Zi=D.create,Li=D.strictCreate,$i=ut.create,Di=Kt.create,qi=lt.create,Hi=pe.create,Bi=ht.create,zi=Ut.create,Wi=Ze.create,Vi=Ve.create,Fi=ft.create,Ji=gt.create,Ki=Ce.create,Qi=pt.create,Gi=Ke.create,Mr=oe.create,Yi=me.create,Xi=Le.create,ea=oe.createWithPreprocess,ta=yt.create,ra=()=>gn().optional(),na=()=>pn().optional(),sa=()=>_n().optional(),ia={string:t=>se.create({...t,coerce:!0}),number:t=>Ie.create({...t,coerce:!0}),boolean:t=>ot.create({...t,coerce:!0}),bigint:t=>Ee.create({...t,coerce:!0}),date:t=>Me.create({...t,coerce:!0})},aa=E;var be=Object.freeze({__proto__:null,defaultErrorMap:it,setErrorMap:ui,getErrorMap:It,makeIssue:Et,EMPTY_PATH:li,addIssueToContext:v,ParseStatus:V,INVALID:E,DIRTY:un,OK:F,isAborted:dr,isDirty:ur,isValid:at,isAsync:Ct,get util(){return j},get objectUtil(){return cr},ZodParsedType:p,getParsedType:Se,ZodType:R,ZodString:se,ZodNumber:Ie,ZodBigInt:Ee,ZodBoolean:ot,ZodDate:Me,ZodSymbol:Rt,ZodUndefined:ct,ZodNull:dt,ZodAny:Je,ZodUnknown:Ae,ZodNever:ye,ZodVoid:Ot,ZodArray:ae,ZodObject:D,ZodUnion:ut,ZodDiscriminatedUnion:Kt,ZodIntersection:lt,ZodTuple:pe,ZodRecord:ht,ZodMap:Ut,ZodSet:Ze,ZodFunction:Ve,ZodLazy:ft,ZodLiteral:gt,ZodEnum:Ce,ZodNativeEnum:pt,ZodPromise:Ke,ZodEffects:oe,ZodTransformer:oe,ZodOptional:me,ZodNullable:Le,ZodDefault:_t,ZodCatch:Pt,ZodNaN:At,BRAND:Si,ZodBranded:hn,ZodPipeline:yt,ZodReadonly:jt,custom:fn,Schema:R,ZodSchema:R,late:xi,get ZodFirstPartyTypeKind(){return S},coerce:ia,any:Pi,array:Mi,bigint:Ei,boolean:_n,date:Ci,discriminatedUnion:Di,effect:Mr,enum:Ki,function:Vi,instanceof:Ti,intersection:qi,lazy:Fi,literal:Ji,map:zi,nan:Ii,nativeEnum:Qi,never:ji,null:Ui,nullable:Xi,number:pn,object:Zi,oboolean:sa,onumber:na,optional:Yi,ostring:ra,pipeline:ta,preprocess:ea,promise:Gi,record:Bi,set:Wi,strictObject:Li,string:gn,symbol:Ri,transformer:Mr,tuple:Hi,undefined:Oi,union:$i,unknown:Ai,void:Ni,NEVER:aa,ZodIssueCode:f,quotelessJson:di,ZodError:ie});const vn="https://cloud-iam.keycloakify.dev/",mn="keycloakify",yn="starter",{OidcProvider:oa,useOidc:wn}=cn({issuerUri:`${vn}/realms/${mn}`,clientId:yn,extraQueryParams:()=>({ui_locales:"en",my_custom_param:"value of foo transferred to login page"}),publicUrl:window.kcContext===void 0?"/":window.kcContext.url.resourcesPath+"/build/",decodedIdTokenSchema:be.object({sub:be.string(),name:be.string(),preferred_username:be.string(),favorite_pet:be.union([be.literal("cat"),be.literal("dog"),be.literal("bird")])})});function ca(t){const{locale:e}=t,r=new URL(`${vn}/realms/${mn}/account`),n=new URLSearchParams;return n.append("kc_locale",e),n.append("referrer",yn),n.append("referrer_uri",window.location.href),r.search=n.toString(),r.toString()}function ha(){return z.jsx(oa,{children:z.jsx(da,{})})}function da(){const{isUserLoggedIn:t,login:e,logout:r,oidcTokens:n}=wn();return z.jsx("div",{className:"App",children:z.jsxs("div",{children:[z.jsx("div",{className:"App-payload",children:t?z.jsxs(z.Fragment,{children:[z.jsxs("h1",{children:["Hello ",n.decodedIdToken.name," !"]}),z.jsx("a",{href:ca({locale:"en"}),children:"Link to your Keycloak account"}),"",z.jsx("button",{onClick:()=>r({redirectTo:"home"}),children:"Logout"}),z.jsx(ua,{})]}):z.jsx("button",{onClick:()=>e({doesCurrentHrefRequiresAuth:!1}),children:"Login"})}),z.jsxs("div",{className:"App-logo-wrapper",children:[z.jsx("img",{src:kn,className:"App-logo rotate",alt:"logo"}),"",z.jsx("img",{src:Sn,className:"App-logo",alt:"logo"})]})]})})}function ua(){const{oidcTokens:t}=wn({assertUserLoggedIn:!0});return z.jsx("pre",{style:{textAlign:"left"},children:JSON.stringify(t.decodedIdToken,null,2)})}export{ha as default};
//# sourceMappingURL=index-B0ERFacV.js.map
